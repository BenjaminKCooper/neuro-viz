THREE.VTKLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},Object.assign(THREE.VTKLoader.prototype,THREE.EventDispatcher.prototype,{load:function(t,e,r,a){var n=this,i=new THREE.FileLoader(n.manager);i.setResponseType("arraybuffer"),i.load(t,function(t){e(n.parse(t))},r,a)},parse:function(t){function e(t){var e,r=[],a=[],n=[],i=[],o=/(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)/g,s=/^(\d+)\s+([\s\d]*)/,f=/^POINTS /,l=/^POLYGONS /,u=/^TRIANGLE_STRIPS /,p=/^POINT_DATA[ ]+(\d+)/,d=/^CELL_DATA[ ]+(\d+)/,h=/^COLOR_SCALARS[ ]+(\w+)[ ]+3/,v=/^NORMALS[ ]+(\w+)[ ]+(\w+)/,A=!1,c=!1,y=!1,b=!1,w=!1,x=!1,g=!1,E=t.split("\n");for(var I in E){var m=E[I];if(A)for(;null!==(e=o.exec(m));){var T=parseFloat(e[1]),O=parseFloat(e[2]),R=parseFloat(e[3]);a.push(T,O,R)}else if(c){if(null!==(e=s.exec(m))){var C=parseInt(e[1]),D=e[2].split(/\s+/);if(C>=3)for(var F,P,H=parseInt(D[0]),N=1,S=0;S<C-2;++S)F=parseInt(D[N]),P=parseInt(D[N+1]),r.push(H,F,P),N++}}else if(y){if(null!==(e=s.exec(m))){var C=parseInt(e[1]),D=e[2].split(/\s+/);if(C>=3)for(var H,F,P,S=0;S<C-2;S++)S%2===1?(H=parseInt(D[S]),F=parseInt(D[S+2]),P=parseInt(D[S+1]),r.push(H,F,P)):(H=parseInt(D[S]),F=parseInt(D[S+1]),P=parseInt(D[S+2]),r.push(H,F,P))}}else if(b||w)if(x)for(;null!==(e=o.exec(m));){var L=parseFloat(e[1]),B=parseFloat(e[2]),U=parseFloat(e[3]);n.push(L,B,U)}else if(g)for(;null!==(e=o.exec(m));){var G=parseFloat(e[1]),M=parseFloat(e[2]),j=parseFloat(e[3]);i.push(G,M,j)}null!==l.exec(m)?(c=!0,A=!1,y=!1):null!==f.exec(m)?(c=!1,A=!0,y=!1):null!==u.exec(m)?(c=!1,A=!1,y=!0):null!==p.exec(m)?(b=!0,A=!1,c=!1,y=!1):null!==d.exec(m)?(w=!0,A=!1,c=!1,y=!1):null!==h.exec(m)?(x=!0,g=!1,A=!1,c=!1,y=!1):null!==v.exec(m)&&(g=!0,x=!1,A=!1,c=!1,y=!1)}var V,_="point";if(n.length==r.length&&(_="cell"),"point"==_)V=new THREE.BufferGeometry,V.setIndex(new THREE.BufferAttribute(new Uint32Array(r),1)),V.addAttribute("position",new THREE.BufferAttribute(new Float32Array(a),3)),n.length==a.length&&V.addAttribute("color",new THREE.BufferAttribute(new Float32Array(n),3)),i.length==a.length&&V.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(i),3));else{V=new THREE.Geometry;for(var k,X,K,Y,T,O,R,L,B,U,z=r.length/3,Z=a.length/3,S=0;S<Z;++S)T=a[3*S+0],O=a[3*S+1],R=a[3*S+2],V.vertices.push(new THREE.Vector3(T,O,R));for(var I=0;I<z;++I)X=r[3*I+0],K=r[3*I+1],Y=r[3*I+2],V.faces.push(new THREE.Face3(X,K,Y));if(n.length==3*z)for(var I=0;I<z;++I)k=V.faces[I],L=n[3*I+0],B=n[3*I+1],U=n[3*I+2],k.color=(new THREE.Color).setRGB(L,B,U)}return V}function r(t){function e(t,e){for(var r=e,a=t[r],n=[];10!=a;)n.push(String.fromCharCode(a)),r++,a=t[r];return{start:e,end:r,next:r+1,parsedString:n.join("")}}for(var r,a,n,i,o,s,f,l=new Uint8Array(t),u=new DataView(t),p=[],d=[],h=[],v=[],A=0;;){if(s=e(l,A),f=s.parsedString,0===f.indexOf("POINTS")){for(v.push(f),i=parseInt(f.split(" ")[1],10),r=4*i*3,p=new Float32Array(3*i),a=s.next,n=0;n<i;n++)p[3*n]=u.getFloat32(a,!1),p[3*n+1]=u.getFloat32(a+4,!1),p[3*n+2]=u.getFloat32(a+8,!1),a+=12;s.next=s.next+r+1}else if(0===f.indexOf("TRIANGLE_STRIPS")){var c=parseInt(f.split(" ")[1],10),y=parseInt(f.split(" ")[2],10);r=4*y,h=new Uint32Array(3*y-9*c);var b=0;for(a=s.next,n=0;n<c;n++){var w=u.getInt32(a,!1),x=[];for(a+=4,o=0;o<w;o++)x.push(u.getInt32(a,!1)),a+=4;for(var g=0;g<w-2;g++)g%2?(h[b++]=x[g],h[b++]=x[g+2],h[b++]=x[g+1]):(h[b++]=x[g],h[b++]=x[g+1],h[b++]=x[g+2])}s.next=s.next+r+1}else if(0===f.indexOf("POLYGONS")){var c=parseInt(f.split(" ")[1],10),y=parseInt(f.split(" ")[2],10);r=4*y,h=new Uint32Array(3*y-9*c);var b=0;for(a=s.next,n=0;n<c;n++){var w=u.getInt32(a,!1),x=[];for(a+=4,o=0;o<w;o++)x.push(u.getInt32(a,!1)),a+=4;for(var g=(x[0],1);g<w-1;g++)h[b++]=x[0],h[b++]=x[g],h[b++]=x[g+1]}s.next=s.next+r+1}else if(0===f.indexOf("POINT_DATA")){for(i=parseInt(f.split(" ")[1],10),s=e(l,s.next),r=4*i*3,d=new Float32Array(3*i),a=s.next,n=0;n<i;n++)d[3*n]=u.getFloat32(a,!1),d[3*n+1]=u.getFloat32(a+4,!1),d[3*n+2]=u.getFloat32(a+8,!1),a+=12;s.next=s.next+r}if(A=s.next,A>=l.byteLength)break}var E=new THREE.BufferGeometry;return E.setIndex(new THREE.BufferAttribute(h,1)),E.addAttribute("position",new THREE.BufferAttribute(p,3)),d.length==p.length&&E.addAttribute("normal",new THREE.BufferAttribute(d,3)),E}function a(t){function e(t){var r={};if(1==t.nodeType){if(t.attributes&&t.attributes.length>0){r.attributes={};for(var a=0;a<t.attributes.length;a++){var n=t.attributes.item(a);r.attributes[n.nodeName]=n.nodeValue.trim()}}}else 3==t.nodeType&&(r=t.nodeValue.trim());if(t.hasChildNodes())for(var i=0;i<t.childNodes.length;i++){var o=t.childNodes.item(i),s=o.nodeName;if("undefined"==typeof r[s]){var f=e(o);""!==f&&(r[s]=f)}else{if("undefined"==typeof r[s].push){var l=r[s];r[s]=[l]}var f=e(o);""!==f&&r[s].push(f)}}return r}function r(t){var e,r="undefined"!=typeof Uint8Array?Uint8Array:Array,a=[],n=[],i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=i.length;for(e=0;e<o;e++)a[e]=i[e];for(e=0;e<o;++e)n[i.charCodeAt(e)]=e;n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63;var s,f,l,u,p,o=t.length;if(o%4>0)throw new Error("Invalid string. Length must be a multiple of 4");u="="===t[o-2]?2:"="===t[o-1]?1:0,p=new r(3*o/4-u),f=u>0?o-4:o;var d=0;for(e=0,s=0;e<f;e+=4,s+=3)l=n[t.charCodeAt(e)]<<18|n[t.charCodeAt(e+1)]<<12|n[t.charCodeAt(e+2)]<<6|n[t.charCodeAt(e+3)],p[d++]=(16711680&l)>>16,p[d++]=(65280&l)>>8,p[d++]=255&l;return 2===u?(l=n[t.charCodeAt(e)]<<2|n[t.charCodeAt(e+1)]>>4,p[d++]=255&l):1===u&&(l=n[t.charCodeAt(e)]<<10|n[t.charCodeAt(e+1)]<<4|n[t.charCodeAt(e+2)]>>2,p[d++]=l>>8&255,p[d++]=255&l),p}function a(t,e){if("binary"==t.attributes.format){if(e)if(t["#text"].indexOf("==")!=-1){var a=t["#text"].split("==");if(2==a.length){var n=a.shift(),i=a.shift();""===i&&(i=n+"==")}else if(a.length>2){var n=a.shift(),i=a.shift();i+="=="}else if(a.length<2){var i=a.shift();i+="=="}var o=r(i),s=new Zlib.Inflate(o,{resize:!0,verify:!0}),i=s.decompress()}else var i=r(t["#text"]);else var i=r(t["#text"]);var i=i.buffer}else if(t["#text"])var i=t["#text"].replace(/\n/g," ").split(" ").filter(function(t,e,r){if(""!==t)return t});else var i=new Int32Array(0).buffer;if(delete t["#text"],"Float32"==t.attributes.type){var f=new Float32Array(i);"binary"==t.attributes.format&&(e||(f=f.filter(function(t,e,r){if(0!==e)return!0})))}else if("Int64"===t.attributes.type){var f=new Int32Array(i);"binary"==t.attributes.format&&(e||(f=f.filter(function(t,e,r){if(0!==e)return!0})),f=f.filter(function(t,e,r){if(e%2!==1)return!0}))}return f}var n=null;if(window.DOMParser)try{n=(new DOMParser).parseFromString(t,"text/xml")}catch(t){n=null}else{if(!window.ActiveXObject)throw new Error("Cannot parse xml string!");try{if(n=new ActiveXObject("Microsoft.XMLDOM"),n.async=!1,!n.loadXML(xml))throw new Error(n.parseError.reason+n.parseError.srcText)}catch(t){n=null}}var i=n.documentElement,o=e(i),s=[],f=[],l=[];if(o.PolyData){for(var u=o.PolyData.Piece,p=o.attributes.hasOwnProperty("compressor"),d=["PointData","Points","Strips","Polys"],h=0,v=d.length;h<v;){var A=u[d[h]];if(A.DataArray){if("[object Array]"===Object.prototype.toString.call(A.DataArray))var c=A.DataArray;else var c=[A.DataArray];for(var y=0,b=c.length;y<b;)c[y].text=a(c[y],p),y++;switch(d[h]){case"PointData":var w=parseInt(u.attributes.NumberOfPoints),x=A.attributes.Normals;if(w>0)for(var g=0,E=c.length;g<E;g++)if(x==c[g].attributes.Name){var I=c[g].attributes.NumberOfComponents;f=new Float32Array(w*I),f.set(c[g].text,0)}break;case"Points":var w=parseInt(u.attributes.NumberOfPoints);if(w>0){var I=A.DataArray.attributes.NumberOfComponents;s=new Float32Array(w*I),s.set(A.DataArray.text,0)}break;case"Strips":var m=parseInt(u.attributes.NumberOfStrips);if(m>0){var T=new Int32Array(A.DataArray[0].text.length),O=new Int32Array(A.DataArray[1].text.length);T.set(A.DataArray[0].text,0),O.set(A.DataArray[1].text,0);var R=m+T.length;l=new Uint32Array(3*R-9*m);for(var C=0,g=0,E=m;g<E;g++){for(var D=[],F=0,P=O[g],H=0;F<P-H;F++)D.push(T[F]),g>0&&(H=O[g-1]);for(var N=0,P=O[g],H=0;N<P-H-2;N++)N%2?(l[C++]=D[N],l[C++]=D[N+2],l[C++]=D[N+1]):(l[C++]=D[N],l[C++]=D[N+1],l[C++]=D[N+2]),g>0&&(H=O[g-1])}}break;case"Polys":var S=parseInt(u.attributes.NumberOfPolys);if(S>0){var T=new Int32Array(A.DataArray[0].text.length),O=new Int32Array(A.DataArray[1].text.length);T.set(A.DataArray[0].text,0),O.set(A.DataArray[1].text,0);var R=S+T.length;l=new Uint32Array(3*R-9*S);for(var C=0,L=0,g=0,E=S,H=0;g<E;){for(var B=[],F=0,P=O[g];F<P-H;)B.push(T[L++]),F++;for(var N=1;N<P-H-1;)l[C++]=B[0],l[C++]=B[N],l[C++]=B[N+1],N++;g++,H=O[g-1]}}}}h++}var U=new THREE.BufferGeometry;return U.setIndex(new THREE.BufferAttribute(l,1)),U.addAttribute("position",new THREE.BufferAttribute(s,3)),f.length==s.length&&U.addAttribute("normal",new THREE.BufferAttribute(f,3)),U}}function n(t){for(var e="",r=new Uint8Array(t),a=0,n=r.length;n--;)e+=String.fromCharCode(r[a++]);return e}var i=String.fromCharCode.apply(null,new Uint8Array(t,0,250)).split("\n");return i[0].indexOf("xml")!==-1?a(n(t)):i[2].includes("ASCII")?e(n(t)):r(t)}});