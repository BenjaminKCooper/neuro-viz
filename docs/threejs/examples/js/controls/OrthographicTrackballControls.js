THREE.OrthographicTrackballControls=function(e,t){function o(e){u.enabled!==!1&&(window.removeEventListener("keydown",o),v=l,l===E.NONE&&(e.keyCode!==u.keys[E.ROTATE]||u.noRotate?e.keyCode!==u.keys[E.ZOOM]||u.noZoom?e.keyCode!==u.keys[E.PAN]||u.noPan||(l=E.PAN):l=E.ZOOM:l=E.ROTATE))}function n(e){u.enabled!==!1&&(l=v,window.addEventListener("keydown",o,!1))}function s(e){u.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),l===E.NONE&&(l=e.button),l!==E.ROTATE||u.noRotate?l!==E.ZOOM||u.noZoom?l!==E.PAN||u.noPan||(R.copy(A(e.pageX,e.pageY)),L.copy(R)):(w.copy(A(e.pageX,e.pageY)),T.copy(w)):(y.copy(M(e.pageX,e.pageY)),f.copy(y)),document.addEventListener("mousemove",i,!1),document.addEventListener("mouseup",c,!1),u.dispatchEvent(H))}function i(e){u.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),l!==E.ROTATE||u.noRotate?l!==E.ZOOM||u.noZoom?l!==E.PAN||u.noPan||L.copy(A(e.pageX,e.pageY)):T.copy(A(e.pageX,e.pageY)):f.copy(M(e.pageX,e.pageY)))}function c(e){u.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),l=E.NONE,document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",c),u.dispatchEvent(k))}function a(e){u.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),w.y+=.01*e.deltaY,u.dispatchEvent(H),u.dispatchEvent(k))}function r(e){if(u.enabled!==!1){switch(e.touches.length){case 1:l=E.TOUCH_ROTATE,y.copy(M(e.touches[0].pageX,e.touches[0].pageY)),f.copy(y);break;case 2:l=E.TOUCH_ZOOM_PAN;var t=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY;j=O=Math.sqrt(t*t+o*o);var n=(e.touches[0].pageX+e.touches[1].pageX)/2,s=(e.touches[0].pageY+e.touches[1].pageY)/2;R.copy(A(n,s)),L.copy(R);break;default:l=E.NONE}u.dispatchEvent(H)}}function h(e){if(u.enabled!==!1)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:f.copy(M(e.touches[0].pageX,e.touches[0].pageY));break;case 2:var t=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY;j=Math.sqrt(t*t+o*o);var n=(e.touches[0].pageX+e.touches[1].pageX)/2,s=(e.touches[0].pageY+e.touches[1].pageY)/2;L.copy(A(n,s));break;default:l=E.NONE}}function p(e){if(u.enabled!==!1){switch(e.touches.length){case 1:f.copy(M(e.touches[0].pageX,e.touches[0].pageY)),y.copy(f);break;case 2:O=j=0;var t=(e.touches[0].pageX+e.touches[1].pageX)/2,o=(e.touches[0].pageY+e.touches[1].pageY)/2;L.copy(A(t,o)),R.copy(L)}l=E.NONE,u.dispatchEvent(k)}}function d(e){e.preventDefault()}var u=this,E={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.radius=0,this.rotateSpeed=1,this.zoomSpeed=1.2,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.noRoll=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.keys=[65,83,68],this.target=new THREE.Vector3;var m=1e-6,g=!0,l=E.NONE,v=E.NONE,b=new THREE.Vector3,y=new THREE.Vector3,f=new THREE.Vector3,w=new THREE.Vector2,T=new THREE.Vector2,O=0,j=0,R=new THREE.Vector2,L=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.left0=this.object.left,this.right0=this.object.right,this.top0=this.object.top,this.bottom0=this.object.bottom;var N={type:"change"},H={type:"start"},k={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}this.radius=.5*Math.min(this.screen.width,this.screen.height),this.left0=this.object.left,this.right0=this.object.right,this.top0=this.object.top,this.bottom0=this.object.bottom},this.handleEvent=function(e){"function"==typeof this[e.type]&&this[e.type](e)};var A=function(){var e=new THREE.Vector2;return function(t,o){return e.set((t-u.screen.left)/u.screen.width,(o-u.screen.top)/u.screen.height),e}}(),M=function(){var e=new THREE.Vector3,t=new THREE.Vector3,o=new THREE.Vector3;return function(n,s){o.set((n-.5*u.screen.width-u.screen.left)/u.radius,(.5*u.screen.height+u.screen.top-s)/u.radius,0);var i=o.length();return u.noRoll?i<Math.SQRT1_2?o.z=Math.sqrt(1-i*i):o.z=.5/i:i>1?o.normalize():o.z=Math.sqrt(1-i*i),b.copy(u.object.position).sub(u.target),e.copy(u.object.up).setLength(o.y),e.add(t.copy(u.object.up).cross(b).setLength(o.x)),e.add(b.setLength(o.z)),e}}();this.rotateCamera=function(){var e=new THREE.Vector3,t=new THREE.Quaternion;return function(){var o=Math.acos(y.dot(f)/y.length()/f.length());o&&(e.crossVectors(y,f).normalize(),o*=u.rotateSpeed,t.setFromAxisAngle(e,-o),b.applyQuaternion(t),u.object.up.applyQuaternion(t),f.applyQuaternion(t),u.staticMoving?y.copy(f):(t.setFromAxisAngle(e,o*(u.dynamicDampingFactor-1)),y.applyQuaternion(t)),g=!0)}}(),this.zoomCamera=function(){if(l===E.TOUCH_ZOOM_PAN){var e=j/O;O=j,u.object.zoom*=e,g=!0}else{var e=1+(T.y-w.y)*u.zoomSpeed;Math.abs(e-1)>m&&e>0&&(u.object.zoom/=e,u.staticMoving?w.copy(T):w.y+=(T.y-w.y)*this.dynamicDampingFactor,g=!0)}},this.panCamera=function(){var e=new THREE.Vector2,t=new THREE.Vector3,o=new THREE.Vector3;return function(){if(e.copy(L).sub(R),e.lengthSq()){var n=(u.object.right-u.object.left)/u.object.zoom,s=(u.object.top-u.object.bottom)/u.object.zoom;e.x*=n,e.y*=s,o.copy(b).cross(u.object.up).setLength(e.x),o.add(t.copy(u.object.up).setLength(e.y)),u.object.position.add(o),u.target.add(o),u.staticMoving?R.copy(L):R.add(e.subVectors(L,R).multiplyScalar(u.dynamicDampingFactor)),g=!0}}}(),this.update=function(){b.subVectors(u.object.position,u.target),u.noRotate||u.rotateCamera(),u.noZoom||(u.zoomCamera(),g&&u.object.updateProjectionMatrix()),u.noPan||u.panCamera(),u.object.position.addVectors(u.target,b),u.object.lookAt(u.target),g&&(u.dispatchEvent(N),g=!1)},this.reset=function(){l=E.NONE,v=E.NONE,u.target.copy(u.target0),u.object.position.copy(u.position0),u.object.up.copy(u.up0),b.subVectors(u.object.position,u.target),u.object.left=u.left0,u.object.right=u.right0,u.object.top=u.top0,u.object.bottom=u.bottom0,u.object.lookAt(u.target),u.dispatchEvent(N),g=!1},this.dispose=function(){this.domElement.removeEventListener("contextmenu",d,!1),this.domElement.removeEventListener("mousedown",s,!1),this.domElement.removeEventListener("wheel",a,!1),this.domElement.removeEventListener("touchstart",r,!1),this.domElement.removeEventListener("touchend",p,!1),this.domElement.removeEventListener("touchmove",h,!1),document.removeEventListener("mousemove",i,!1),document.removeEventListener("mouseup",c,!1),window.removeEventListener("keydown",o,!1),window.removeEventListener("keyup",n,!1)},this.domElement.addEventListener("contextmenu",d,!1),this.domElement.addEventListener("mousedown",s,!1),this.domElement.addEventListener("wheel",a,!1),this.domElement.addEventListener("touchstart",r,!1),this.domElement.addEventListener("touchend",p,!1),this.domElement.addEventListener("touchmove",h,!1),window.addEventListener("keydown",o,!1),window.addEventListener("keyup",n,!1),this.handleResize(),this.update()},THREE.OrthographicTrackballControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrthographicTrackballControls.prototype.constructor=THREE.OrthographicTrackballControls;