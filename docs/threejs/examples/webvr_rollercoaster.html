<!DOCTYPE html><html lang="en"><head>
		<title>three.js webvr - roller coaster</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
		<style>
			body {
				margin: 0px;
				color: #fff;
				font-family: Monospace;
				background-color: #444;
				overflow: hidden;
			}
			a {
				color: #00f;
			}
		</style>
	</head>
	<body>

		<script src="../build/three.js"></script>

		<script src="js/RollerCoaster.js"></script>

		<script src="js/controls/VRControls.js"></script>
		<script src="js/effects/VREffect.js"></script>
		<script src="js/vr/WebVR.js"></script>

		<script>function animate(e){effect.requestAnimationFrame(animate);for(var t=60*clock.getDelta(),r=0;r<funfairs.length;r++)funfairs[r].rotation.y=2e-4*e;progress+=velocity*t,progress%=1,position.copy(curve.getPointAt(progress)),position.y+=3,train.position.copy(position),tangent.copy(curve.getTangentAt(progress)),velocity-=15e-7*tangent.y*t,velocity=Math.max(velocity,4e-5),train.lookAt(lookAt.copy(position).sub(tangent)),controls.update(),effect.render(scene,camera)}WEBVR.isAvailable()===!1&&document.body.appendChild(WEBVR.getMessage());var renderer=new THREE.WebGLRenderer({antialias:!0});renderer.setClearColor(15790335),renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(renderer.domElement);var scene=new THREE.Scene,light=new THREE.HemisphereLight(16773360,6316134);light.position.set(1,1,1),scene.add(light);var train=new THREE.Object3D;scene.add(train);var camera=new THREE.PerspectiveCamera(40,window.innerWidth/window.innerHeight,1,5e3);camera.rotation.y=Math.PI,train.add(camera);var geometry=new THREE.PlaneGeometry(5e3,5e3,15,15);geometry.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));for(var material=new THREE.MeshLambertMaterial({color:4222976,shading:THREE.FlatShading}),i=0;i<geometry.vertices.length;i++){var vertex=geometry.vertices[i];vertex.x+=100*Math.random()-50,vertex.z+=100*Math.random()-50;var distance=vertex.distanceTo(scene.position)/5-250;vertex.y=Math.random()*Math.max(0,distance)}geometry.computeFaceNormals();var mesh=new THREE.Mesh(geometry,material);scene.add(mesh);var geometry=new TreesGeometry(mesh),material=new THREE.MeshBasicMaterial({side:THREE.DoubleSide,vertexColors:THREE.VertexColors}),mesh=new THREE.Mesh(geometry,material);scene.add(mesh);var geometry=new SkyGeometry,material=new THREE.MeshBasicMaterial({color:16777215}),mesh=new THREE.Mesh(geometry,material);scene.add(mesh);var PI2=2*Math.PI,curve=function(){var e=new THREE.Vector3,t=new THREE.Vector3;return{getPointAt:function(t){t*=Math.PI;var r=Math.sin(4*t)*Math.cos(6*t)*1e3,a=80*Math.cos(8*t)+40*Math.cos(20*t*Math.sin(t))+200,n=Math.sin(5*t)*Math.sin(3*t)*1e3;return e.set(r,a,n)},getTangentAt:function(e){var r=1e-4,a=Math.max(0,e-r),n=Math.min(1,e+r);return t.copy(this.getPointAt(n)).sub(this.getPointAt(a)).normalize()}}}(),geometry=new RollerCoasterGeometry(curve,1500),material=new THREE.MeshStandardMaterial({roughness:.1,metalness:0,vertexColors:THREE.VertexColors}),mesh=new THREE.Mesh(geometry,material);scene.add(mesh);var geometry=new RollerCoasterLiftersGeometry(curve,100),material=new THREE.MeshStandardMaterial({roughness:.1,metalness:0}),mesh=new THREE.Mesh(geometry,material);mesh.position.y=1,scene.add(mesh);var geometry=new RollerCoasterShadowGeometry(curve,500),material=new THREE.MeshBasicMaterial({color:0,opacity:.1,depthWrite:!1,transparent:!0}),mesh=new THREE.Mesh(geometry,material);mesh.position.y=1,scene.add(mesh);var funfairs=[],geometry=new THREE.CylinderGeometry(100,100,50,15),material=new THREE.MeshLambertMaterial({color:16744576,shading:THREE.FlatShading}),mesh=new THREE.Mesh(geometry,material);mesh.position.set(-800,100,-700),mesh.rotation.x=Math.PI/2,scene.add(mesh),funfairs.push(mesh);var geometry=new THREE.CylinderGeometry(50,60,40,10),material=new THREE.MeshLambertMaterial({color:8421631,shading:THREE.FlatShading}),mesh=new THREE.Mesh(geometry,material);mesh.position.set(500,20,300),scene.add(mesh),funfairs.push(mesh);var controls=new THREE.VRControls(camera),effect=new THREE.VREffect(renderer);WEBVR.isAvailable()===!0&&document.body.appendChild(WEBVR.getButton(effect)),window.addEventListener("resize",function(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)},!1);var position=new THREE.Vector3,tangent=new THREE.Vector3,lookAt=new THREE.Vector3,velocity=0,progress=0,clock=new THREE.Clock;effect.requestAnimationFrame(animate);</script>

	

</body></html>