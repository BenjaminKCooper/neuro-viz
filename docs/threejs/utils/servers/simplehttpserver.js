function handleRequest(e,r){var t=urlParser.parse(e.url,!0),n=decodeURIComponent(t.pathname);console.log("["+(new Date).toUTCString()+'] "'+e.method+" "+n+'"');var o=path.join(currentDir,n);fs.stat(o,function(e,t){return e?(r.writeHead(404,{}),void r.end("File not found!")):void(t.isFile()?fs.readFile(o,function(e,t){return e?(r.writeHead(404,{}),void r.end("Opps. Resource not found")):(r.writeHead(200,{}),r.write(t),void r.end())}):t.isDirectory()&&fs.readdir(o,function(e,t){if(e)return r.writeHead(500,{}),void r.end();var i=n.length;"/"!=n.substring(i-1)&&(n+="/"),r.writeHead(200,{"Content-Type":"text/html"}),r.write('<!DOCTYPE html>\n<html><head><meta charset="UTF-8"><title>'+o+"</title></head><body>"),r.write("<h1>"+o+"</h1>"),r.write('<ul style="list-style:none;font-family:courier new;">'),t.unshift(".",".."),t.forEach(function(e){var t=n+e,o=fs.statSync(currentDir+t);o.isDirectory()&&(t+="/",e+="/"),r.write('<li><a href="'+t+'">'+e+"</a></li>")}),r.end("</ul></body></html>")}))})}var port=8e3,http=require("http"),urlParser=require("url"),fs=require("fs"),path=require("path"),currentDir=process.cwd();port=process.argv[2]?parseInt(process.argv[2],0):port,http.createServer(handleRequest).listen(port),require("dns").lookup(require("os").hostname(),function(e,r,t){console.log("Running at http://"+r+(80===port?"":":")+port+"/")}),console.log("Three.js server has started..."),console.log("Base directory at "+currentDir);