module("RemoveScriptCommand"),test("Test RemoveScriptCommand (Undo and Redo)",function(){var e=new Editor,t=aBox("The scripted box"),n=aSphere("The scripted sphere"),o=[t,n],i={name:"",source:"function update( event ) { this.position.x = this.position.x + 1; }"},a={name:"",source:"function update( event ) { this.position.y = this.position.y + 1; }"},r=[i,a];o.map(function(t){e.execute(new AddObjectCommand(t))}),ok(2==e.scene.children.length,"OK, the box and the sphere have been added");for(var d=0;d<r.length;d++){var s=new AddScriptCommand(o[d],r[d]);s.updatable=!1,e.execute(s)}for(var d=0;d<r.length;d++){var s=new RemoveScriptCommand(o[d],r[d]);s.updatable=!1,e.execute(s)}ok(0==getScriptCount(e),"OK, all scripts have been removed"),r.map(function(){e.undo()}),ok(getScriptCount(e)==r.length,"OK, all scripts have been added again by undo(s)");for(var c=Object.keys(e.scripts),d=0;d<c.length;d++)ok(e.scripts[c[d]][0]==r[d],"OK, script #"+d+" is still assigned correctly");e.redo(),ok(getScriptCount(e)==r.length-1,"OK, one script has been removed again by redo")});