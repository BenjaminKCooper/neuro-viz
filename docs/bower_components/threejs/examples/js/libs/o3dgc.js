var o3dgc=function(){"use strict";function t(){var t,e,i;return e=new ArrayBuffer(4),t=new Uint32Array(e),i=new Uint8Array(e),t[0]=1,1===i[0]?s.O3DGC_LITTLE_ENDIAN:s.O3DGC_BIG_ENDIAN}function e(t,e,i,r){var o,n,_,m,a,h,d;for(o=-1,n=!1,m=e.m_value,a=0,_=a;_<m;++_){if(t.Equal(i[_].m_id)){n=!0;break}if(t.Less(i[_].m_id)){for(e.m_value<s.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS&&++e.m_value,h=e.m_value-1;h>_;--h)for(i[h].m_id.m_a=i[h-1].m_id.m_a,i[h].m_id.m_b=i[h-1].m_id.m_b,i[h].m_id.m_c=i[h-1].m_id.m_c,d=0;d<r;++d)i[h].m_pred[d]=i[h-1].m_pred[d];i[_].m_id.m_a=t.m_a,i[_].m_id.m_b=t.m_b,i[_].m_id.m_c=t.m_c,o=_,n=!0;break}}return!n&&e.m_value<s.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS&&(o=e.m_value++,i[o].m_id.m_a=t.m_a,i[o].m_id.m_b=t.m_b,i[o].m_id.m_c=t.m_c),o}function i(t,e){var i,r,o;i=Math.abs(t.m_x),r=Math.abs(t.m_y),o=Math.abs(t.m_z),o>=i&&o>=r?t.m_z>=0?(e.m_z=0,e.m_x=t.m_x,e.m_y=t.m_y):(e.m_z=1,e.m_x=-t.m_x,e.m_y=-t.m_y):r>=i&&r>=o?t.m_y>=0?(e.m_z=2,e.m_x=t.m_z,e.m_y=t.m_x):(e.m_z=3,e.m_x=-t.m_z,e.m_y=-t.m_x):t.m_x>=0?(e.m_z=4,e.m_x=t.m_y,e.m_y=t.m_z):(e.m_z=5,e.m_x=-t.m_y,e.m_y=-t.m_z)}function r(t){return t<0?-1-2*t:2*t}function o(t){return 1&t?-(t+1>>>1):t>>>1}function n(t,i,r,o,n,_,m,s){var h,d,u,c,C,l;for(l=new a.SC3DMCTriplet(-1,-1,-1),d=0;d<3;++d)if(c=t[3*i+d],c<r&&(l.m_a=-1,l.m_b=-1,l.m_c=c,u=e(l,o,n,_),u!==-1))for(h=c*s,C=0;C<_;++C)n[u].m_pred[C]=m[h+C]}function _(t,i,r,o,n,_,m,s,h,d){var u,c,C,l,A,f,p,D,S,I,T,y,O,G,M,N,R,b;if(u=3*i,b=new a.SC3DMCTriplet(-1,-1,-1),t[u]===r?(f=t[u+1],p=t[u+2]):t[u+1]===r?(f=t[u],p=t[u+2]):(f=t[u],p=t[u+1]),f<r&&p<r)for(y=h.Begin(f),O=h.End(f),G=y;G<O&&(M=d[G],!(M<0));++G){for(c=3*M,D=-1,N=!1,T=0;T<3;++T)S=t[c+T],S===p?N=!0:S<r&&S!==f&&(D=S);if(D!==-1&&N&&(f<p?(b.m_a=f,b.m_b=p):(b.m_a=p,b.m_b=f),b.m_c=-D-1,R=e(b,o,n,_),R!==-1))for(C=f*s,l=p*s,A=D*s,I=0;I<_;++I)n[R].m_pred[I]=m[C+I]+m[l+I]-m[A+I]}}function m(t,e,i,r,o){var n,_,m,s,h,d,u,c,C,l;for(l=new a.Vec3,c=new a.Vec3,C=new a.Vec3,m=3*r,_=0;_<m;++_)o[_]=0;for(s=0;s<e;++s)n=3*s,h=3*t[n],d=3*t[n+1],u=3*t[n+2],c.m_x=i[d]-i[h],c.m_y=i[d+1]-i[h+1],c.m_z=i[d+2]-i[h+2],C.m_x=i[u]-i[h],C.m_y=i[u+1]-i[h+1],C.m_z=i[u+2]-i[h+2],l.m_x=c.m_y*C.m_z-c.m_z*C.m_y,l.m_y=c.m_z*C.m_x-c.m_x*C.m_z,l.m_z=c.m_x*C.m_y-c.m_y*C.m_x,o[h]+=l.m_x,o[h+1]+=l.m_y,o[h+2]+=l.m_z,o[d]+=l.m_x,o[d+1]+=l.m_y,o[d+2]+=l.m_z,o[u]+=l.m_x,o[u+1]+=l.m_y,o[u+2]+=l.m_z}var a,s;return a={},s={},s.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL0=7,s.O3DGC_BINARY_STREAM_MAX_SYMBOL0=127,s.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL1=6,s.O3DGC_BINARY_STREAM_MAX_SYMBOL1=63,s.O3DGC_BINARY_STREAM_NUM_SYMBOLS_UINT32=5,s.O3DGC_BIG_ENDIAN=0,s.O3DGC_LITTLE_ENDIAN=1,s.O3DGC_MAX_DOUBLE=1.79769e308,s.O3DGC_MIN_LONG=-2147483647,s.O3DGC_MAX_LONG=2147483647,s.O3DGC_MAX_UCHAR8=255,s.O3DGC_MAX_TFAN_SIZE=256,s.O3DGC_MAX_ULONG=4294967295,s.O3DGC_SC3DMC_START_CODE=497,s.O3DGC_DV_START_CODE=498,s.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES=256,s.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES=256,s.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES=32,s.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS=2,s.O3DGC_SC3DMC_BINARIZATION_FL=0,s.O3DGC_SC3DMC_BINARIZATION_BP=1,s.O3DGC_SC3DMC_BINARIZATION_FC=2,s.O3DGC_SC3DMC_BINARIZATION_AC=3,s.O3DGC_SC3DMC_BINARIZATION_AC_EGC=4,s.O3DGC_SC3DMC_BINARIZATION_ASCII=5,s.O3DGC_STREAM_TYPE_UNKOWN=0,s.O3DGC_STREAM_TYPE_ASCII=1,s.O3DGC_STREAM_TYPE_BINARY=2,s.O3DGC_SC3DMC_NO_PREDICTION=0,s.O3DGC_SC3DMC_DIFFERENTIAL_PREDICTION=1,s.O3DGC_SC3DMC_XOR_PREDICTION=2,s.O3DGC_SC3DMC_ADAPTIVE_DIFFERENTIAL_PREDICTION=3,s.O3DGC_SC3DMC_CIRCULAR_DIFFERENTIAL_PREDICTION=4,s.O3DGC_SC3DMC_PARALLELOGRAM_PREDICTION=5,s.O3DGC_SC3DMC_SURF_NORMALS_PREDICTION=6,s.O3DGC_SC3DMC_ENCODE_MODE_QBCR=0,s.O3DGC_SC3DMC_ENCODE_MODE_SVA=1,s.O3DGC_SC3DMC_ENCODE_MODE_TFAN=2,s.O3DGC_DYNAMIC_VECTOR_ENCODE_MODE_LIFT=0,s.O3DGC_MIN_NEIGHBORS_SIZE=128,s.O3DGC_MIN_NUM_NEIGHBORS_SIZE=16,s.O3DGC_TFANS_MIN_SIZE_ALLOCATED_VERTICES_BUFFER=128,s.O3DGC_TFANS_MIN_SIZE_TFAN_SIZE_BUFFER=8,s.O3DGC_DEFAULT_VECTOR_SIZE=32,a.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_UNKOWN=0,a.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_POSITION=1,a.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_NORMAL=2,a.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_COLOR=3,a.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_TEXCOORD=4,a.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_WEIGHT=5,a.O3DGC_IFS_INT_ATTRIBUTE_TYPE_UNKOWN=0,a.O3DGC_IFS_INT_ATTRIBUTE_TYPE_INDEX=1,a.O3DGC_IFS_INT_ATTRIBUTE_TYPE_JOINT_ID=2,a.O3DGC_IFS_INT_ATTRIBUTE_TYPE_INDEX_BUFFER_ID=3,a.O3DGC_OK=0,a.O3DGC_ERROR_BUFFER_FULL=1,a.O3DGC_ERROR_CORRUPTED_STREAM=5,a.O3DGC_ERROR_NON_SUPPORTED_FEATURE=6,a.O3DGC_ERROR_AC=7,a.SC3DMCStats=function(){this.m_timeCoord=0,this.m_timeNormal=0,this.m_timeCoordIndex=0,this.m_timeFloatAttribute=new Float32Array(s.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_timeIntAttribute=new Float32Array(s.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES),this.m_timeReorder=0,this.m_streamSizeCoord=0,this.m_streamSizeNormal=0,this.m_streamSizeCoordIndex=0,this.m_streamSizeFloatAttribute=new Uint32Array(s.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_streamSizeIntAttribute=new Uint32Array(s.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES)},a.SC3DMCTriplet=function(t,e,i){this.m_a=t,this.m_b=e,this.m_c=i},a.SC3DMCTriplet.prototype.Less=function(t){var e;return e=this.m_c!==t.m_c?this.m_c<t.m_c:this.m_b!==t.m_b?this.m_b<t.m_b:this.m_a<t.m_a},a.SC3DMCTriplet.prototype.Equal=function(t){return this.m_c===t.m_c&&this.m_b===t.m_b&&this.m_a===t.m_a},a.SC3DMCPredictor=function(){this.m_id=new a.SC3DMCTriplet(-1,-1,-1),this.m_pred=new Float32Array(s.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES)},"undefined"==typeof window.performance&&(window.performance={}),window.performance.now||(s.nowOffset=Date.now(),performance.timing&&performance.timing.navigationStart&&(s.nowOffset=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-s.nowOffset}),a.Timer=function(){this.m_start=0,this.m_end=0},a.Timer.prototype.Tic=function(){this.m_start=window.performance.now()},a.Timer.prototype.Toc=function(){this.m_end=window.performance.now()},a.Timer.prototype.GetElapsedTime=function(){return this.m_end-this.m_start},a.Vec3=function(t,e,i){this.m_x=t,this.m_y=e,this.m_z=i},a.Vec3.prototype.Set=function(t,e,i){this.m_x=t,this.m_y=e,this.m_z=i},a.Vec3.prototype.Sub=function(t,e){this.m_x=t.m_x-e.m_x,this.m_y=t.m_y-e.m_y,this.m_z=t.m_z-e.m_z},a.Vec3.prototype.Add=function(t,e){this.m_x=t.m_x+e.m_x,this.m_y=t.m_y+e.m_y,this.m_z=t.m_z+e.m_z},a.Vec3.prototype.SelfAdd=function(t){this.m_x+=t.m_x,this.m_y+=t.m_y,this.m_z+=t.m_z},a.Vec3.prototype.Cross=function(t,e){this.m_x=t.m_y*e.m_z-t.m_z*e.m_y,this.m_y=t.m_z*e.m_x-t.m_x*e.m_z,this.m_z=t.m_x*e.m_y-t.m_y*e.m_x},a.Vec3.prototype.GetNorm=function(){return Math.sqrt(this.m_x*this.m_x+this.m_y*this.m_y+this.m_z*this.m_z)},s.CubeToSphere={0:function(t,e){e.m_x=t.m_x,e.m_y=t.m_y,e.m_z=Math.sqrt(Math.max(0,1-e.m_x*e.m_x-e.m_y*e.m_y))},1:function(t,e){e.m_x=-t.m_x,e.m_y=-t.m_y,e.m_z=-Math.sqrt(Math.max(0,1-e.m_x*e.m_x-e.m_y*e.m_y))},2:function(t,e){e.m_z=t.m_x,e.m_x=t.m_y,e.m_y=Math.sqrt(Math.max(0,1-e.m_x*e.m_x-e.m_z*e.m_z))},3:function(t,e){e.m_z=-t.m_x,e.m_x=-t.m_y,e.m_y=-Math.sqrt(Math.max(0,1-e.m_x*e.m_x-e.m_z*e.m_z))},4:function(t,e){e.m_y=t.m_x,e.m_z=t.m_y,e.m_x=Math.sqrt(Math.max(0,1-e.m_y*e.m_y-e.m_z*e.m_z))},5:function(t,e){e.m_y=-t.m_x,e.m_z=-t.m_y,e.m_x=-Math.sqrt(Math.max(0,1-e.m_y*e.m_y-e.m_z*e.m_z))}},a.Iterator=function(){this.m_count=0},a.NumberRef=function(){this.m_value=0},a.BinaryStream=function(e){this.m_endianness=t(),this.m_buffer=e,this.m_stream=new Uint8Array(this.m_buffer),this.m_localBuffer=new ArrayBuffer(4),this.m_localBufferViewUChar8=new Uint8Array(this.m_localBuffer),this.m_localBufferViewFloat32=new Float32Array(this.m_localBuffer),this.m_localBufferViewUInt32=new Uint32Array(this.m_localBuffer)},a.BinaryStream.prototype.ReadFloat32Bin=function(t){return this.m_endianness===s.O3DGC_BIG_ENDIAN?(this.m_localBufferViewUChar8[3]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[2]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[1]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[0]=this.m_stream[t.m_count++]):(this.m_localBufferViewUChar8[0]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[1]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[2]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[3]=this.m_stream[t.m_count++]),this.m_localBufferViewFloat32[0]},a.BinaryStream.prototype.ReadUInt32Bin=function(t){return this.m_endianness===s.O3DGC_BIG_ENDIAN?(this.m_localBufferViewUChar8[3]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[2]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[1]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[0]=this.m_stream[t.m_count++]):(this.m_localBufferViewUChar8[0]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[1]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[2]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[3]=this.m_stream[t.m_count++]),this.m_localBufferViewUInt32[0]},a.BinaryStream.prototype.ReadUChar8Bin=function(t){return this.m_stream[t.m_count++]},a.BinaryStream.prototype.ReadUInt32ASCII=function(t){var e,i,r;for(e=0,i=0,r=0;r<s.O3DGC_BINARY_STREAM_NUM_SYMBOLS_UINT32;++r)e+=this.m_stream[t.m_count++]<<i>>>0,i+=s.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL0;return e},a.BinaryStream.prototype.ReadFloat32ASCII=function(t){var e=this.ReadUInt32ASCII(t);return this.m_endianness===s.O3DGC_BIG_ENDIAN?(this.m_localBufferViewUChar8[3]=e&s.O3DGC_MAX_UCHAR8,e>>>=8,this.m_localBufferViewUChar8[2]=e&s.O3DGC_MAX_UCHAR8,e>>>=8,this.m_localBufferViewUChar8[1]=e&s.O3DGC_MAX_UCHAR8,e>>>=8,this.m_localBufferViewUChar8[0]=e&s.O3DGC_MAX_UCHAR8):(this.m_localBufferViewUChar8[0]=e&s.O3DGC_MAX_UCHAR8,e>>>=8,this.m_localBufferViewUChar8[1]=e&s.O3DGC_MAX_UCHAR8,e>>>=8,this.m_localBufferViewUChar8[2]=e&s.O3DGC_MAX_UCHAR8,e>>>=8,this.m_localBufferViewUChar8[3]=e&s.O3DGC_MAX_UCHAR8),this.m_localBufferViewFloat32[0]},a.BinaryStream.prototype.ReadIntASCII=function(t){return o(this.ReadUIntASCII(t))},a.BinaryStream.prototype.ReadUIntASCII=function(t){var e,i,r;if(r=this.m_stream[t.m_count++],r===s.O3DGC_BINARY_STREAM_MAX_SYMBOL0){e=0;do i=this.m_stream[t.m_count++],r+=i>>>1<<e>>>0,e+=s.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL1;while(1&i)}return r},a.BinaryStream.prototype.ReadUCharASCII=function(t){return this.m_stream[t.m_count++]},a.BinaryStream.prototype.ReadFloat32=function(t,e){return e===s.O3DGC_STREAM_TYPE_ASCII?this.ReadFloat32ASCII(t):this.ReadFloat32Bin(t)},a.BinaryStream.prototype.ReadUInt32=function(t,e){return e===s.O3DGC_STREAM_TYPE_ASCII?this.ReadUInt32ASCII(t):this.ReadUInt32Bin(t)},a.BinaryStream.prototype.ReadUChar=function(t,e){return e===s.O3DGC_STREAM_TYPE_ASCII?this.ReadUCharASCII(t):this.ReadUChar8Bin(t)},a.BinaryStream.prototype.GetBuffer=function(t,e){return new Uint8Array(this.m_buffer,t.m_count,e)},s.O3DGC_AC_MIN_LENGTH=16777216,s.O3DGC_AC_MAX_LENGTH=4294967295,s.O3DGC_AC_BM_LENGTH_SHIFT=13,s.O3DGC_AC_BM_MAX_COUNT=1<<s.O3DGC_AC_BM_LENGTH_SHIFT>>>0,s.O3DGC_AC_DM_LENGTH_SHIFT=15,s.O3DGC_AC_DM_MAX_COUNT=1<<s.O3DGC_AC_DM_LENGTH_SHIFT>>>0,a.StaticBitModel=function(){this.m_bit0Prob=1<<s.O3DGC_AC_BM_LENGTH_SHIFT-1>>>0},a.StaticBitModel.prototype.SetProbability=function(t){this.m_bit0Prob=Math.floor(t*(1<<s.O3DGC_AC_BM_LENGTH_SHIFT>>>0))},a.AdaptiveBitModel=function(){this.m_updateCycle=4,this.m_bitsUntilUpdate=4,this.m_bit0Prob=1<<s.O3DGC_AC_BM_LENGTH_SHIFT-1>>>0,this.m_bit0Count=1,this.m_bitCount=2},a.AdaptiveBitModel.prototype.Reset=function(){this.m_updateCycle=4,this.m_bitsUntilUpdate=4,this.m_bit0Prob=1<<s.O3DGC_AC_BM_LENGTH_SHIFT-1>>>0,this.m_bit0Count=1,this.m_bitCount=2},a.AdaptiveBitModel.prototype.Update=function(){(this.m_bitCount+=this.m_updateCycle)>s.O3DGC_AC_BM_MAX_COUNT&&(this.m_bitCount=this.m_bitCount+1>>>1,this.m_bit0Count=this.m_bit0Count+1>>>1,this.m_bit0Count===this.m_bitCount&&++this.m_bitCount);var t=Math.floor(2147483648/this.m_bitCount);this.m_bit0Prob=this.m_bit0Count*t>>>31-s.O3DGC_AC_BM_LENGTH_SHIFT,this.m_updateCycle=5*this.m_updateCycle>>>2,this.m_updateCycle>64&&(this.m_updateCycle=64),this.m_bitsUntilUpdate=this.m_updateCycle},a.AdaptiveDataModel=function(){this.m_buffer={},this.m_distribution={},this.m_symbolCount={},this.m_decoderTable={},this.m_totalCount=0,this.m_updateCycle=0,this.m_symbolsUntilUpdate=0,this.m_dataSymbols=0,this.m_lastSymbol=0,this.m_tableSize=0,this.m_tableShift=0},a.AdaptiveDataModel.prototype.Update=function(){var t,e,i,r,o,n,_;if((this.m_totalCount+=this.m_updateCycle)>s.O3DGC_AC_DM_MAX_COUNT)for(this.m_totalCount=0,t=0;t<this.m_dataSymbols;++t)this.m_totalCount+=this.m_symbolCount[t]=this.m_symbolCount[t]+1>>>1;if(e=0,i=0,r=Math.floor(2147483648/this.m_totalCount),0===this.m_tableSize)for(o=0;o<this.m_dataSymbols;++o)this.m_distribution[o]=r*e>>>31-s.O3DGC_AC_DM_LENGTH_SHIFT,e+=this.m_symbolCount[o];else{for(o=0;o<this.m_dataSymbols;++o)for(this.m_distribution[o]=r*e>>>31-s.O3DGC_AC_DM_LENGTH_SHIFT,e+=this.m_symbolCount[o],_=this.m_distribution[o]>>>this.m_tableShift;i<_;)this.m_decoderTable[++i]=o-1;for(this.m_decoderTable[0]=0;i<=this.m_tableSize;)this.m_decoderTable[++i]=this.m_dataSymbols-1}this.m_updateCycle=5*this.m_updateCycle>>>2,n=this.m_dataSymbols+6<<3>>>0,this.m_updateCycle>n&&(this.m_updateCycle=n),this.m_symbolsUntilUpdate=this.m_updateCycle},a.AdaptiveDataModel.prototype.Reset=function(){var t;if(0!==this.m_dataSymbols){for(this.m_totalCount=0,this.m_updateCycle=this.m_dataSymbols,t=0;t<this.m_dataSymbols;++t)this.m_symbolCount[t]=1;this.Update(),this.m_symbolsUntilUpdate=this.m_updateCycle=this.m_dataSymbols+6>>>1}},a.AdaptiveDataModel.prototype.SetAlphabet=function(t){if(t<2||t>2048)return Console.log("invalid number of data symbols"),a.O3DGC_ERROR_AC;if(this.m_dataSymbols!==t)if(this.m_dataSymbols=t,this.m_lastSymbol=this.m_dataSymbols-1,this.m_dataSymbols>16){for(var e=3;this.m_dataSymbols>1<<e+2>>>0;)++e;this.m_tableSize=1<<e>>>0,this.m_tableShift=s.O3DGC_AC_DM_LENGTH_SHIFT-e,this.m_buffer=new ArrayBuffer(4*(2*this.m_dataSymbols+this.m_tableSize+2)),this.m_distribution=new Uint32Array(this.m_buffer,0,this.m_dataSymbols),this.m_symbolCount=new Uint32Array(this.m_buffer,4*this.m_dataSymbols,this.m_dataSymbols),this.m_decoderTable=new Uint32Array(this.m_buffer,8*this.m_dataSymbols,this.m_tableSize+2)}else this.m_tableSize=this.m_tableShift=0,this.m_buffer=new ArrayBuffer(8*this.m_dataSymbols),this.m_distribution=new Uint32Array(this.m_buffer,0,this.m_dataSymbols),this.m_symbolCount=new Uint32Array(this.m_buffer,4*this.m_dataSymbols,this.m_dataSymbols),this.m_decoderTable={};return this.Reset(),a.O3DGC_OK},a.ArithmeticDecoder=function(){this.m_codeBuffer={},this.m_acShift=0,this.m_base=0,this.m_value=0,this.m_length=0,this.m_bufferSize=0,this.m_mode=0},a.ArithmeticDecoder.prototype.SetBuffer=function(t,e){return 0===t?(Console.log("invalid codec buffer size"),a.O3DGC_ERROR_AC):0!==this.m_mode?(Console.log("cannot set buffer while encoding or decoding"),a.O3DGC_ERROR_AC):(this.m_bufferSize=t,void(this.m_codeBuffer=e))},a.ArithmeticDecoder.prototype.StartDecoder=function(){return 0!==this.m_mode?(Console.log("cannot start decoder"),a.O3DGC_ERROR_AC):0===this.m_bufferSize?(Console.log("no code buffer set"),a.O3DGC_ERROR_AC):(this.m_mode=2,this.m_length=s.O3DGC_AC_MAX_LENGTH,this.m_acShift=3,void(this.m_value=(this.m_codeBuffer[0]<<24|this.m_codeBuffer[1]<<16|this.m_codeBuffer[2]<<8|this.m_codeBuffer[3])>>>0))},a.ArithmeticDecoder.prototype.StopDecoder=function(){return 2!==this.m_mode?(Console.log("invalid to stop decoder"),a.O3DGC_ERROR_AC):void(this.m_mode=0)},a.ArithmeticDecoder.prototype.GetBit=function(){this.m_length>>>=1;var t=this.m_value>=this.m_length;return t&&(this.m_value-=this.m_length),this.m_length<s.O3DGC_AC_MIN_LENGTH&&this.RenormDecInterval(),t},a.ArithmeticDecoder.prototype.GetBits=function(t){var e=Math.floor(this.m_value/(this.m_length>>>=t));return this.m_value-=this.m_length*e,this.m_length<s.O3DGC_AC_MIN_LENGTH&&this.RenormDecInterval(),e},a.ArithmeticDecoder.prototype.DecodeStaticBitModel=function(t){var e,i;return e=t.m_bit0Prob*(this.m_length>>>s.O3DGC_AC_BM_LENGTH_SHIFT),i=this.m_value>=e,i?(this.m_value-=e,this.m_length-=e):this.m_length=e,this.m_length<s.O3DGC_AC_MIN_LENGTH&&this.RenormDecInterval(),i},a.ArithmeticDecoder.prototype.DecodeAdaptiveBitModel=function(t){var e,i;return e=t.m_bit0Prob*(this.m_length>>>s.O3DGC_AC_BM_LENGTH_SHIFT),i=this.m_value>=e,i?(this.m_value-=e,this.m_length-=e):(this.m_length=e,++t.m_bit0Count),this.m_length<s.O3DGC_AC_MIN_LENGTH&&this.RenormDecInterval(),0===--t.m_bitsUntilUpdate&&t.Update(),i},a.ArithmeticDecoder.prototype.DecodeAdaptiveDataModel=function(t){var e,i,r,o,n,_,m,a;if(o=this.m_length,t.m_tableSize>0){for(_=Math.floor(this.m_value/(this.m_length>>>=s.O3DGC_AC_DM_LENGTH_SHIFT)),n=_>>>t.m_tableShift,i=t.m_decoderTable[n],e=t.m_decoderTable[n+1]+1;e>i+1;)a=i+e>>>1,t.m_distribution[a]>_?e=a:i=a;r=t.m_distribution[i]*this.m_length,i!==t.m_lastSymbol&&(o=t.m_distribution[i+1]*this.m_length)}else{r=i=0,this.m_length>>>=s.O3DGC_AC_DM_LENGTH_SHIFT,a=(e=t.m_dataSymbols)>>>1;do m=this.m_length*t.m_distribution[a],m>this.m_value?(e=a,o=m):(i=a,r=m);while((a=i+e>>>1)!==i)}return this.m_value-=r,this.m_length=o-r,this.m_length<s.O3DGC_AC_MIN_LENGTH&&this.RenormDecInterval(),++t.m_symbolCount[i],0===--t.m_symbolsUntilUpdate&&t.Update(!1),i},a.ArithmeticDecoder.prototype.ExpGolombDecode=function(t,e,i){var r,o,n;r=0,o=0;do n=this.DecodeAdaptiveBitModel(i),n&&(r+=1<<t>>>0,t++);while(n);for(;t--;)this.DecodeStaticBitModel(e)&&(o=(o|1<<t)>>>0);return r+o},a.ArithmeticDecoder.prototype.RenormDecInterval=function(){do this.m_value=(this.m_value<<8|this.m_codeBuffer[++this.m_acShift])>>>0,this.m_length=this.m_length<<8>>>0;while(this.m_length<s.O3DGC_AC_MIN_LENGTH)},a.ArithmeticDecoder.prototype.DecodeIntACEGC=function(t,e,i,r,n){var _=this.DecodeAdaptiveDataModel(t);return _===n&&(_+=this.ExpGolombDecode(r,e,i)),o(_)},a.ArithmeticDecoder.prototype.DecodeUIntACEGC=function(t,e,i,r,o){var n=this.DecodeAdaptiveDataModel(t);return n===o&&(n+=this.ExpGolombDecode(r,e,i)),n},a.FIFO=function(){this.m_data={},this.m_allocated=0,this.m_size=0,this.m_start=0,this.m_end=0},a.FIFO.prototype.Clear=function(){this.m_start=this.m_end=this.m_size=0},a.FIFO.prototype.GetAllocatedSize=function(){return this.m_allocated},a.FIFO.prototype.GetSize=function(){return this.m_size},a.FIFO.prototype.Allocate=function(t){return t>this.m_allocated&&(this.m_allocated=t,this.m_data=new Int32Array(this.m_allocated)),this.Clear(),a.O3DGC_OK},a.FIFO.prototype.PopFirst=function(){--this.m_size;var t=this.m_start++;return this.m_start===this.m_allocated&&(this.m_end=0),this.m_data[t]},a.FIFO.prototype.PushBack=function(t){--this.m_size,this.m_data[this.m_end]=t,++this.m_size,++this.m_end,this.m_end===this.m_allocated&&(this.m_end=0)},a.IndexedFaceSet=function(){this.m_nCoordIndex=0,this.m_nCoord=0,this.m_nNormal=0,this.m_numFloatAttributes=0,this.m_numIntAttributes=0,this.m_creaseAngle=30,this.m_ccw=!0,this.m_solid=!0,this.m_convex=!0,this.m_isTriangularMesh=!0,this.m_coordMin=new Float32Array(3),this.m_coordMax=new Float32Array(3),this.m_normalMin=new Float32Array(3),this.m_normalMax=new Float32Array(3),this.m_nFloatAttribute=new Uint32Array(s.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_nIntAttribute=new Uint32Array(s.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES),this.m_dimFloatAttribute=new Uint32Array(s.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_dimIntAttribute=new Uint32Array(s.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES),this.m_typeFloatAttribute=new Uint32Array(s.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_typeIntAttribute=new Uint32Array(s.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES),this.m_minFloatAttributeBuffer=new ArrayBuffer(4*s.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES*s.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES),this.m_minFloatAttribute=new Float32Array(this.m_minFloatAttributeBuffer),this.m_maxFloatAttributeBuffer=new ArrayBuffer(4*s.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES*s.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES),this.m_maxFloatAttribute=new Float32Array(this.m_maxFloatAttributeBuffer),this.m_coordIndex={},this.m_coord={},this.m_normal={},this.m_floatAttribute=[],this.m_intAttribute=[]},a.IndexedFaceSet.prototype.GetNCoordIndex=function(){return this.m_nCoordIndex},a.IndexedFaceSet.prototype.GetNCoordIndex=function(){return this.m_nCoordIndex},a.IndexedFaceSet.prototype.GetNCoord=function(){return this.m_nCoord},a.IndexedFaceSet.prototype.GetNNormal=function(){return this.m_nNormal},a.IndexedFaceSet.prototype.GetNFloatAttribute=function(t){return this.m_nFloatAttribute[t]},a.IndexedFaceSet.prototype.GetNIntAttribute=function(t){return this.m_nIntAttribute[t]},a.IndexedFaceSet.prototype.GetNumFloatAttributes=function(){return this.m_numFloatAttributes},a.IndexedFaceSet.prototype.GetNumIntAttributes=function(){return this.m_numIntAttributes},a.IndexedFaceSet.prototype.GetCoordMinArray=function(){return this.m_coordMin},a.IndexedFaceSet.prototype.GetCoordMaxArray=function(){return this.m_coordMax},a.IndexedFaceSet.prototype.GetNormalMinArray=function(){return this.m_normalMin},a.IndexedFaceSet.prototype.GetNormalMaxArray=function(){return this.m_normalMax},a.IndexedFaceSet.prototype.GetFloatAttributeMinArray=function(t){return new Float32Array(this.m_minFloatAttributeBuffer,t*s.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES*4,this.GetFloatAttributeDim(t))},a.IndexedFaceSet.prototype.GetFloatAttributeMaxArray=function(t){return new Float32Array(this.m_maxFloatAttributeBuffer,t*s.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES*4,this.GetFloatAttributeDim(t))},a.IndexedFaceSet.prototype.GetFloatAttributeDim=function(t){return this.m_dimFloatAttribute[t]},a.IndexedFaceSet.prototype.GetIntAttributeDim=function(t){return this.m_dimIntAttribute[t]},a.IndexedFaceSet.prototype.GetFloatAttributeType=function(t){return this.m_typeFloatAttribute[t]},a.IndexedFaceSet.prototype.GetIntAttributeType=function(t){return this.m_typeIntAttribute[t]},a.IndexedFaceSet.prototype.GetFloatAttributeMax=function(t,e){return this.m_maxFloatAttribute[t*s.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES+e]},a.IndexedFaceSet.prototype.GetCreaseAngle=function(){return this.m_creaseAngle},a.IndexedFaceSet.prototype.GetCreaseAngle=function(){return this.m_creaseAngle},a.IndexedFaceSet.prototype.GetCCW=function(){return this.m_ccw},a.IndexedFaceSet.prototype.GetSolid=function(){return this.m_solid},a.IndexedFaceSet.prototype.GetConvex=function(){return this.m_convex},a.IndexedFaceSet.prototype.GetIsTriangularMesh=function(){return this.m_isTriangularMesh},a.IndexedFaceSet.prototype.GetCoordIndex=function(){return this.m_coordIndex},a.IndexedFaceSet.prototype.GetCoordIndex=function(){return this.m_coordIndex},a.IndexedFaceSet.prototype.GetCoord=function(){return this.m_coord},a.IndexedFaceSet.prototype.GetNormal=function(){return this.m_normal},a.IndexedFaceSet.prototype.GetFloatAttribute=function(t){return this.m_floatAttribute[t]},a.IndexedFaceSet.prototype.GetIntAttribute=function(t){return this.m_intAttribute[t]},a.IndexedFaceSet.prototype.SetNCoordIndex=function(t){this.m_nCoordIndex=t},a.IndexedFaceSet.prototype.SetNNormalIndex=function(t){},a.IndexedFaceSet.prototype.SetNormalPerVertex=function(t){},a.IndexedFaceSet.prototype.SetNFloatAttributeIndex=function(t){},a.IndexedFaceSet.prototype.SetNIntAttributeIndex=function(t){},a.IndexedFaceSet.prototype.SetFloatAttributePerVertex=function(t){},a.IndexedFaceSet.prototype.SetIntAttributePerVertex=function(t){},a.IndexedFaceSet.prototype.SetNCoord=function(t){this.m_nCoord=t},a.IndexedFaceSet.prototype.SetNNormal=function(t){this.m_nNormal=t},a.IndexedFaceSet.prototype.SetNumFloatAttributes=function(t){this.m_numFloatAttributes=t},a.IndexedFaceSet.prototype.SetNumIntAttributes=function(t){this.m_numIntAttributes=t},a.IndexedFaceSet.prototype.SetCreaseAngle=function(t){this.m_creaseAngle=t},a.IndexedFaceSet.prototype.SetCCW=function(t){this.m_ccw=t},a.IndexedFaceSet.prototype.SetSolid=function(t){this.m_solid=t},a.IndexedFaceSet.prototype.SetConvex=function(t){this.m_convex=t},a.IndexedFaceSet.prototype.SetIsTriangularMesh=function(t){this.m_isTriangularMesh=t},a.IndexedFaceSet.prototype.SetCoordMin=function(t,e){this.m_coordMin[t]=e},a.IndexedFaceSet.prototype.SetCoordMax=function(t,e){this.m_coordMax[t]=e},a.IndexedFaceSet.prototype.SetNormalMin=function(t,e){this.m_normalMin[t]=e},a.IndexedFaceSet.prototype.SetNormalMax=function(t,e){this.m_normalMax[t]=e},a.IndexedFaceSet.prototype.SetNFloatAttribute=function(t,e){this.m_nFloatAttribute[t]=e},a.IndexedFaceSet.prototype.SetNIntAttribute=function(t,e){this.m_nIntAttribute[t]=e},a.IndexedFaceSet.prototype.SetFloatAttributeDim=function(t,e){this.m_dimFloatAttribute[t]=e},a.IndexedFaceSet.prototype.SetIntAttributeDim=function(t,e){this.m_dimIntAttribute[t]=e},a.IndexedFaceSet.prototype.SetFloatAttributeType=function(t,e){this.m_typeFloatAttribute[t]=e},a.IndexedFaceSet.prototype.SetIntAttributeType=function(t,e){this.m_typeIntAttribute[t]=e},a.IndexedFaceSet.prototype.SetFloatAttributeMin=function(t,e,i){this.m_minFloatAttribute[t*s.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES+e]=i},a.IndexedFaceSet.prototype.SetFloatAttributeMax=function(t,e,i){this.m_maxFloatAttribute[t*s.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES+e]=i},a.IndexedFaceSet.prototype.SetCoordIndex=function(t){this.m_coordIndex=t},a.IndexedFaceSet.prototype.SetCoord=function(t){this.m_coord=t},a.IndexedFaceSet.prototype.SetNormal=function(t){this.m_normal=t},a.IndexedFaceSet.prototype.SetFloatAttribute=function(t,e){this.m_floatAttribute[t]=e},a.IndexedFaceSet.prototype.SetIntAttribute=function(t,e){this.m_intAttribute[t]=e},a.SC3DMCEncodeParams=function(){var t;for(this.m_numFloatAttributes=0,this.m_numIntAttributes=0,this.m_floatAttributeQuantBits=new Uint32Array(s.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_floatAttributePredMode=new Uint32Array(s.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_intAttributePredMode=new Uint32Array(s.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES),this.m_encodeMode=s.O3DGC_SC3DMC_ENCODE_MODE_TFAN,this.m_streamTypeMode=s.O3DGC_STREAM_TYPE_ASCII,this.m_coordQuantBits=14,this.m_normalQuantBits=8,this.m_coordPredMode=s.O3DGC_SC3DMC_PARALLELOGRAM_PREDICTION,this.m_normalPredMode=s.O3DGC_SC3DMC_SURF_NORMALS_PREDICTION,t=0;t<s.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES;++t)this.m_floatAttributePredMode[t]=s.O3DGC_SC3DMC_PARALLELOGRAM_PREDICTION;for(t=0;t<s.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES;++t)this.m_intAttributePredMode[t]=s.O3DGC_SC3DMC_DIFFERENTIAL_PREDICTION},a.SC3DMCEncodeParams.prototype.GetStreamType=function(){return this.m_streamTypeMode},a.SC3DMCEncodeParams.prototype.GetEncodeMode=function(){return this.m_encodeMode},a.SC3DMCEncodeParams.prototype.GetNumFloatAttributes=function(){return this.m_numFloatAttributes},a.SC3DMCEncodeParams.prototype.GetNumIntAttributes=function(){return this.m_numIntAttributes},a.SC3DMCEncodeParams.prototype.GetCoordQuantBits=function(){return this.m_coordQuantBits},a.SC3DMCEncodeParams.prototype.GetNormalQuantBits=function(){return this.m_normalQuantBits},a.SC3DMCEncodeParams.prototype.GetFloatAttributeQuantBits=function(t){return this.m_floatAttributeQuantBits[t]},a.SC3DMCEncodeParams.prototype.GetCoordPredMode=function(){return this.m_coordPredMode},a.SC3DMCEncodeParams.prototype.GetNormalPredMode=function(){return this.m_normalPredMode},a.SC3DMCEncodeParams.prototype.GetFloatAttributePredMode=function(t){return this.m_floatAttributePredMode[t]},a.SC3DMCEncodeParams.prototype.GetIntAttributePredMode=function(t){return this.m_intAttributePredMode[t]},a.SC3DMCEncodeParams.prototype.GetCoordPredMode=function(){return this.m_coordPredMode},a.SC3DMCEncodeParams.prototype.GetNormalPredMode=function(){return this.m_normalPredMode},a.SC3DMCEncodeParams.prototype.GetFloatAttributePredMode=function(t){return this.m_floatAttributePredMode[t]},a.SC3DMCEncodeParams.prototype.GetIntAttributePredMode=function(t){return this.m_intAttributePredMode[t]},a.SC3DMCEncodeParams.prototype.SetStreamType=function(t){this.m_streamTypeMode=t},a.SC3DMCEncodeParams.prototype.SetEncodeMode=function(t){this.m_encodeMode=t},a.SC3DMCEncodeParams.prototype.SetNumFloatAttributes=function(t){this.m_numFloatAttributes=t},a.SC3DMCEncodeParams.prototype.SetNumIntAttributes=function(t){this.m_numIntAttributes=t},a.SC3DMCEncodeParams.prototype.SetCoordQuantBits=function(t){this.m_coordQuantBits=t},a.SC3DMCEncodeParams.prototype.SetNormalQuantBits=function(t){this.m_normalQuantBits=t},a.SC3DMCEncodeParams.prototype.SetFloatAttributeQuantBits=function(t,e){this.m_floatAttributeQuantBits[t]=e},a.SC3DMCEncodeParams.prototype.SetCoordPredMode=function(t){this.m_coordPredMode=t},a.SC3DMCEncodeParams.prototype.SetNormalPredMode=function(t){this.m_normalPredMode=t},a.SC3DMCEncodeParams.prototype.SetFloatAttributePredMode=function(t,e){this.m_floatAttributePredMode[t]=e},a.SC3DMCEncodeParams.prototype.SetIntAttributePredMode=function(t,e){this.m_intAttributePredMode[t]=e},a.AdjacencyInfo=function(){this.m_neighborsSize=0,this.m_numNeighborsSize=0,this.m_numElements=0,this.m_neighbors={},this.m_numNeighbors={}},a.AdjacencyInfo.prototype.Allocate=function(t,e){return this.m_numElements=t,e>this.m_neighborsSize&&(this.m_neighborsSize=e,this.m_neighbors=new Int32Array(this.m_neighborsSize)),t>this.m_numNeighborsSize&&(this.m_numNeighborsSize=t,this.m_numNeighbors=new Int32Array(this.m_numNeighborsSize)),a.O3DGC_OK},a.AdjacencyInfo.prototype.AllocateNumNeighborsArray=function(t){return t>this.m_numNeighborsSize&&(this.m_numNeighborsSize=t,this.m_numNeighbors=new Int32Array(this.m_numNeighborsSize)),this.m_numElements=t,a.O3DGC_OK},a.AdjacencyInfo.prototype.AllocateNeighborsArray=function(){var t;for(t=1;t<this.m_numElements;++t)this.m_numNeighbors[t]+=this.m_numNeighbors[t-1];return this.m_numNeighbors[this.m_numElements-1]>this.m_neighborsSize&&(this.m_neighborsSize=this.m_numNeighbors[this.m_numElements-1],this.m_neighbors=new Int32Array(this.m_neighborsSize)),a.O3DGC_OK},a.AdjacencyInfo.prototype.ClearNumNeighborsArray=function(){var t;for(t=0;t<this.m_numElements;++t)this.m_numNeighbors[t]=0;return a.O3DGC_OK},a.AdjacencyInfo.prototype.ClearNeighborsArray=function(){var t;for(t=0;t<this.m_neighborsSize;++t)this.m_neighbors[t]=-1;return a.O3DGC_OK},a.AdjacencyInfo.prototype.Begin=function(t){return t>0?this.m_numNeighbors[t-1]:0},a.AdjacencyInfo.prototype.End=function(t){return this.m_numNeighbors[t]},a.AdjacencyInfo.prototype.AddNeighbor=function(t,e){var i,r,o;for(r=this.Begin(t),o=this.End(t),i=r;i<o;++i)if(this.m_neighbors[i]===-1)return this.m_neighbors[i]=e,a.O3DGC_OK;return a.O3DGC_ERROR_BUFFER_FULL},a.AdjacencyInfo.prototype.GetNeighbor=function(t){return this.m_neighbors[t]},a.AdjacencyInfo.prototype.GetNumNeighbors=function(t){return this.End(t)-this.Begin(t)},a.AdjacencyInfo.prototype.GetNumNeighborsBuffer=function(){return this.m_numNeighbors},a.AdjacencyInfo.prototype.GetNeighborsBuffer=function(){return this.m_neighbors},a.Vector=function(){this.m_data={},this.m_allocated=0,this.m_size=0},a.Vector.prototype.Clear=function(){this.m_size=0},a.Vector.prototype.Get=function(t){return this.m_data[t]},a.Vector.prototype.GetAllocatedSize=function(){return this.m_allocated},a.Vector.prototype.GetSize=function(){return this.m_size},a.Vector.prototype.GetBuffer=function(){return this.m_data},a.Vector.prototype.SetSize=function(t){this.m_size=t},a.Vector.prototype.Allocate=function(t){var e,i;if(t>this.m_allocated){if(this.m_allocated=t,i=new Int32Array(this.m_allocated),this.m_size>0)for(e=0;e<this.m_size;++e)i[e]=this.m_data[e];this.m_data=i}},a.Vector.prototype.PushBack=function(t){var e,i;if(this.m_size===this.m_allocated){if(this.m_allocated*=2,this.m_allocated<s.O3DGC_DEFAULT_VECTOR_SIZE&&(this.m_allocated=s.O3DGC_DEFAULT_VECTOR_SIZE),i=new Int32Array(this.m_allocated),this.m_size>0)for(e=0;e<this.m_size;++e)i[e]=this.m_data[e];this.m_data=i}this.m_data[this.m_size++]=t},a.CompressedTriangleFans=function(){this.m_numTFANs=new a.Vector,this.m_degrees=new a.Vector,this.m_configs=new a.Vector,this.m_operations=new a.Vector,this.m_indices=new a.Vector,this.m_trianglesOrder=new a.Vector,this.m_streamType=s.O3DGC_STREAM_TYPE_UNKOWN;
},a.CompressedTriangleFans.prototype.GetStreamType=function(){return this.m_streamType},a.CompressedTriangleFans.prototype.SetStreamType=function(t){this.m_streamType=t},a.CompressedTriangleFans.prototype.Clear=function(){return this.m_numTFANs.Clear(),this.m_degrees.Clear(),this.m_configs.Clear(),this.m_operations.Clear(),this.m_indices.Clear(),a.O3DGC_OK},a.CompressedTriangleFans.prototype.Allocate=function(t,e){return this.m_numTFANs.Allocate(t),this.m_degrees.Allocate(2*t),this.m_configs.Allocate(2*t),this.m_operations.Allocate(2*t),this.m_indices.Allocate(2*t),this.m_trianglesOrder.Allocate(e),this.Clear(),a.O3DGC_OK},a.CompressedTriangleFans.prototype.PushNumTFans=function(t){this.m_numTFANs.PushBack(t)},a.CompressedTriangleFans.prototype.ReadNumTFans=function(t){return this.m_numTFANs.Get(t.m_count++)},a.CompressedTriangleFans.prototype.PushDegree=function(t){this.m_degrees.PushBack(t)},a.CompressedTriangleFans.prototype.ReadDegree=function(t){return this.m_degrees.Get(t.m_count++)},a.CompressedTriangleFans.prototype.PushConfig=function(t){this.m_configs.PushBack(t)},a.CompressedTriangleFans.prototype.ReadConfig=function(t){return this.m_configs.Get(t.m_count++)},a.CompressedTriangleFans.prototype.PushOperation=function(t){this.m_operations.PushBack(t)},a.CompressedTriangleFans.prototype.ReadOperation=function(t){return this.m_operations.Get(t.m_count++)},a.CompressedTriangleFans.prototype.PushIndex=function(t){this.m_indices.PushBack(t)},a.CompressedTriangleFans.prototype.ReadIndex=function(t){return this.m_indices.Get(t.m_count++)},a.CompressedTriangleFans.prototype.PushTriangleIndex=function(t){this.m_trianglesOrder.PushBack(r(t))},a.CompressedTriangleFans.prototype.ReadTriangleIndex=function(t){return o(this.m_trianglesOrder.Get(t.m_count++))},a.CompressedTriangleFans.prototype.LoadUIntData=function(t,e,i){var r,o;for(e.ReadUInt32ASCII(i),r=e.ReadUInt32ASCII(i),t.Allocate(r),t.Clear(),o=0;o<r;++o)t.PushBack(e.ReadUIntASCII(i));return a.O3DGC_OK},a.CompressedTriangleFans.prototype.LoadIntData=function(t,e,i){var r,o;for(e.ReadUInt32ASCII(i),r=e.ReadUInt32ASCII(i),t.Allocate(r),t.Clear(),o=0;o<r;++o)t.PushBack(e.ReadIntASCII(i));return a.O3DGC_OK},a.CompressedTriangleFans.prototype.LoadBinData=function(t,e,i){var r,o,n,_;for(e.ReadUInt32ASCII(i),r=e.ReadUInt32ASCII(i),t.Allocate(r*s.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL0),t.Clear(),n=0;n<r;)for(o=e.ReadUCharASCII(i),_=0;_<s.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL0;++_)t.PushBack(1&o),o>>>=1,++n;return a.O3DGC_OK},a.CompressedTriangleFans.prototype.LoadUIntAC=function(t,e,i,r){var o,n,_,m,s,h,d;if(o=i.ReadUInt32Bin(r)-12,n=i.ReadUInt32Bin(r),0===n)return a.O3DGC_OK;for(_=i.ReadUInt32Bin(r),m=i.GetBuffer(r,o),r.m_count+=o,t.Allocate(n),s=new a.ArithmeticDecoder,s.SetBuffer(o,m),s.StartDecoder(),h=new a.AdaptiveDataModel,h.SetAlphabet(e+1),d=0;d<n;++d)t.PushBack(s.DecodeAdaptiveDataModel(h)+_);return a.O3DGC_OK},a.CompressedTriangleFans.prototype.LoadIntACEGC=function(t,e,i,r){var o,n,_,m,h,d,u,c,C,l;if(o=i.ReadUInt32Bin(r)-12,n=i.ReadUInt32Bin(r),0===n)return a.O3DGC_OK;for(_=i.ReadUInt32Bin(r)-s.O3DGC_MAX_LONG,m=i.GetBuffer(r,o),r.m_count+=o,t.Allocate(n),h=new a.ArithmeticDecoder,h.SetBuffer(o,m),h.StartDecoder(),d=new a.AdaptiveDataModel,d.SetAlphabet(e+2),u=new a.StaticBitModel,c=new a.AdaptiveBitModel,l=0;l<n;++l)C=h.DecodeAdaptiveDataModel(d),C===e&&(C+=h.ExpGolombDecode(0,u,c)),t.PushBack(C+_);return a.O3DGC_OK},a.CompressedTriangleFans.prototype.LoadBinAC=function(t,e,i){var r,o,n,_,m,s;if(r=e.ReadUInt32Bin(i)-8,o=e.ReadUInt32Bin(i),0===o)return a.O3DGC_OK;for(n=e.GetBuffer(i,r),i.m_count+=r,t.Allocate(o),_=new a.ArithmeticDecoder,_.SetBuffer(r,n),_.StartDecoder(),m=new a.AdaptiveBitModel,s=0;s<o;++s)t.PushBack(_.DecodeAdaptiveBitModel(m));return a.O3DGC_OK},a.CompressedTriangleFans.prototype.Load=function(t,e,i,r){return r===s.O3DGC_STREAM_TYPE_ASCII?(this.LoadUIntData(this.m_numTFANs,t,e),this.LoadUIntData(this.m_degrees,t,e),this.LoadUIntData(this.m_configs,t,e),this.LoadBinData(this.m_operations,t,e),this.LoadIntData(this.m_indices,t,e),i&&this.LoadUIntData(this.m_trianglesOrder,t,e)):(this.LoadIntACEGC(this.m_numTFANs,4,t,e),this.LoadIntACEGC(this.m_degrees,16,t,e),this.LoadUIntAC(this.m_configs,10,t,e),this.LoadBinAC(this.m_operations,t,e),this.LoadIntACEGC(this.m_indices,8,t,e),i&&this.LoadIntACEGC(this.m_trianglesOrder,16,t,e)),a.O3DGC_OK},a.TriangleFans=function(){this.m_verticesAllocatedSize=0,this.m_sizeTFANAllocatedSize=0,this.m_numTFANs=0,this.m_numVertices=0,this.m_sizeTFAN={},this.m_vertices={}},a.TriangleFans.prototype.Allocate=function(t,e){return this.m_numTFANs=0,this.m_numVertices=0,this.m_verticesAllocatedSize<e&&(this.m_verticesAllocatedSize=e,this.m_vertices=new Int32Array(this.m_verticesAllocatedSize)),this.m_sizeTFANAllocatedSize<t&&(this.m_sizeTFANAllocatedSize=t,this.m_sizeTFAN=new Int32Array(this.m_sizeTFANAllocatedSize)),a.O3DGC_OK},a.TriangleFans.prototype.Clear=function(){return this.m_numTFANs=0,this.m_numVertices=0,a.O3DGC_OK},a.TriangleFans.prototype.AddVertex=function(t){var e,i;if(++this.m_numVertices,this.m_numVertices>this.m_verticesAllocatedSize){for(this.m_verticesAllocatedSize*=2,i=new Int32Array(this.m_verticesAllocatedSize),e=0;e<this.m_numVertices;++e)i[e]=this.m_vertices[e];this.m_vertices=i}return this.m_vertices[this.m_numVertices-1]=t,++this.m_sizeTFAN[this.m_numTFANs-1],a.O3DGC_OK},a.TriangleFans.prototype.AddTFAN=function(){var t,e;if(++this.m_numTFANs,this.m_numTFANs>this.m_sizeTFANAllocatedSize){for(this.m_sizeTFANAllocatedSize*=2,e=new Int32Array(this.m_sizeTFANAllocatedSize),t=0;t<this.m_numTFANs;++t)e[t]=this.m_sizeTFAN[t];this.m_sizeTFAN=e}return this.m_sizeTFAN[this.m_numTFANs-1]=this.m_numTFANs>1?this.m_sizeTFAN[this.m_numTFANs-2]:0,a.O3DGC_OK},a.TriangleFans.prototype.Begin=function(t){return t>0?this.m_sizeTFAN[t-1]:0},a.TriangleFans.prototype.End=function(t){return this.m_sizeTFAN[t]},a.TriangleFans.prototype.GetVertex=function(t){return this.m_vertices[t]},a.TriangleFans.prototype.GetTFANSize=function(t){return this.End(t)-this.Begin(t)},a.TriangleFans.prototype.GetNumTFANs=function(){return this.m_numTFANs},a.TriangleFans.prototype.GetNumVertices=function(){return this.m_numVertices},a.TriangleListDecoder=function(){this.m_itNumTFans=new a.Iterator,this.m_itDegree=new a.Iterator,this.m_itConfig=new a.Iterator,this.m_itOperation=new a.Iterator,this.m_itIndex=new a.Iterator,this.m_maxNumVertices=0,this.m_maxNumTriangles=0,this.m_numTriangles=0,this.m_numVertices=0,this.m_tempTrianglesSize=0,this.m_vertexCount=0,this.m_triangleCount=0,this.m_numConqueredTriangles=0,this.m_numVisitedVertices=0,this.m_triangles={},this.m_tempTriangles={},this.m_visitedVertices={},this.m_visitedVerticesValence={},this.m_vertexToTriangle=new a.AdjacencyInfo,this.m_ctfans=new a.CompressedTriangleFans,this.m_tfans=new a.TriangleFans,this.m_streamType=s.O3DGC_STREAM_TYPE_ASCII,this.m_decodeTrianglesOrder=!1,this.m_decodeVerticesOrder=!1,this.m_processConfig={0:function(t,e){var i;for(t.m_tfans.AddVertex(t.m_visitedVertices[0]),i=1;i<e-1;++i)t.m_visitedVertices[t.m_numVisitedVertices++]=t.m_vertexCount,t.m_tfans.AddVertex(t.m_vertexCount++);t.m_tfans.AddVertex(t.m_visitedVertices[1])},1:function(t,e,i){var r,o,n;for(t.m_tfans.AddVertex(t.m_visitedVertices[0]),r=1;r<e-1;++r)o=t.m_ctfans.ReadOperation(t.m_itOperation),1===o?(n=t.m_ctfans.ReadIndex(t.m_itIndex),n<0?t.m_tfans.AddVertex(t.m_visitedVertices[-n-1]):t.m_tfans.AddVertex(n+i)):(t.m_visitedVertices[t.m_numVisitedVertices++]=t.m_vertexCount,t.m_tfans.AddVertex(t.m_vertexCount++));t.m_tfans.AddVertex(t.m_visitedVertices[1])},2:function(t,e){var i;for(i=0;i<e-1;++i)t.m_visitedVertices[t.m_numVisitedVertices++]=t.m_vertexCount,t.m_tfans.AddVertex(t.m_vertexCount++);t.m_tfans.AddVertex(t.m_visitedVertices[0])},3:function(t,e){var i;for(i=0;i<e-1;++i)t.m_visitedVertices[t.m_numVisitedVertices++]=t.m_vertexCount,t.m_tfans.AddVertex(t.m_vertexCount++);t.m_tfans.AddVertex(t.m_visitedVertices[1])},4:function(t,e){var i;for(t.m_tfans.AddVertex(t.m_visitedVertices[0]),i=1;i<e;++i)t.m_visitedVertices[t.m_numVisitedVertices++]=t.m_vertexCount,t.m_tfans.AddVertex(t.m_vertexCount++)},5:function(t,e){var i;for(t.m_tfans.AddVertex(t.m_visitedVertices[1]),i=1;i<e;++i)t.m_visitedVertices[t.m_numVisitedVertices++]=t.m_vertexCount,t.m_tfans.AddVertex(t.m_vertexCount++)},6:function(t,e){var i;for(i=0;i<e;++i)t.m_visitedVertices[t.m_numVisitedVertices++]=t.m_vertexCount,t.m_tfans.AddVertex(t.m_vertexCount++)},7:function(t,e){var i;for(t.m_tfans.AddVertex(t.m_visitedVertices[1]),i=1;i<e-1;++i)t.m_visitedVertices[t.m_numVisitedVertices++]=t.m_vertexCount,t.m_tfans.AddVertex(t.m_vertexCount++);t.m_tfans.AddVertex(t.m_visitedVertices[0])},8:function(t,e,i){var r,o,n;for(t.m_tfans.AddVertex(t.m_visitedVertices[1]),r=1;r<e-1;++r)o=t.m_ctfans.ReadOperation(t.m_itOperation),1===o?(n=t.m_ctfans.ReadIndex(t.m_itIndex),n<0?t.m_tfans.AddVertex(t.m_visitedVertices[-n-1]):t.m_tfans.AddVertex(n+i)):(t.m_visitedVertices[t.m_numVisitedVertices++]=t.m_vertexCount,t.m_tfans.AddVertex(t.m_vertexCount++));t.m_tfans.AddVertex(t.m_visitedVertices[0])},9:function(t,e,i){var r,o,n;for(r=0;r<e;++r)o=t.m_ctfans.ReadOperation(t.m_itOperation),1===o?(n=t.m_ctfans.ReadIndex(t.m_itIndex),n<0?t.m_tfans.AddVertex(t.m_visitedVertices[-n-1]):t.m_tfans.AddVertex(n+i)):(t.m_visitedVertices[t.m_numVisitedVertices++]=t.m_vertexCount,t.m_tfans.AddVertex(t.m_vertexCount++))}}},a.TriangleListDecoder.prototype.GetStreamType=function(){return this.m_streamType},a.TriangleListDecoder.prototype.GetReorderTriangles=function(){return this.m_decodeTrianglesOrder},a.TriangleListDecoder.prototype.GetReorderVertices=function(){return this.m_decodeVerticesOrder},a.TriangleListDecoder.prototype.SetStreamType=function(t){this.m_streamType=t},a.TriangleListDecoder.prototype.GetVertexToTriangle=function(){return this.m_vertexToTriangle},a.TriangleListDecoder.prototype.Reorder=function(){var t,e,i,r,n,_,m,s;if(this.m_decodeTrianglesOrder)for(t=this.m_triangles,e=this.m_numTriangles,i=this.m_ctfans.m_trianglesOrder.m_data,_=this.m_tempTriangles,_.set(t),r=0,n=0,s=0;s<e;++s)m=o(i[r++])+n,t[3*m]=_[3*s],t[3*m+1]=_[3*s+1],t[3*m+2]=_[3*s+2],n=m+1;return a.O3DGC_OK},a.TriangleListDecoder.prototype.CompueLocalConnectivityInfo=function(t){var e,i,r,o,n,_,m,s,h,d,u,c,C,l,A,f,p,D,S;for(e=this.m_visitedVertices,i=this.m_visitedVerticesValence,r=this.m_triangles,o=this.m_vertexToTriangle,n=o.Begin(t),_=o.End(t),m=0,h=0,p=0,u=n;p>=0&&u<_;++u)if(p=o.GetNeighbor(u),p>=0)for(++m,D=3*p,C=0;C<3;++C)if(S=r[D+C],S>t){for(s=!1,c=0;c<h;++c){if(S===e[c]){i[c]++,s=!0;break}if(S<e[c]){for(++h,l=h-1;l>c;--l)e[l]=e[l-1],i[l]=i[l-1];e[c]=S,i[c]=1,s=!0;break}}s||(e[h]=S,i[h]=1,h++)}if(h>2)for(A=1;A<h;++A)if(1===i[A])for(f=A;f>0&&i[f]<i[f-1];)d=i[f],i[f]=i[f-1],i[f-1]=d,d=e[f],e[f]=e[f-1],e[f-1]=d,--f;return this.m_numConqueredTriangles=m,this.m_numVisitedVertices=h,a.O3DGC_OK},a.TriangleListDecoder.prototype.DecompressTFAN=function(t){var e,i,r,o,n,_,m,s,h,d,u,c,C,l,A,f,p,D,S;if(e=this.m_vertexToTriangle,i=this.m_triangles,r=this.m_itDegree,o=this.m_itConfig,n=this.m_tfans,m=this.m_processConfig,s=this.m_ctfans,h=this.m_triangleCount,d=this.m_numConqueredTriangles,_=s.ReadNumTFans(this.m_itNumTFans),_>0)for(D=0;D<_;++D)for(n.AddTFAN(),u=s.ReadDegree(r)+2-d,c=s.ReadConfig(o),C=n.GetNumVertices(),n.AddVertex(t),m[c](this,u,t),l=n.GetNumVertices(),A=n.GetVertex(C+1),S=C+2;S<l;++S)f=n.GetVertex(S),p=3*h,i[p++]=t,i[p++]=A,i[p]=f,e.AddNeighbor(t,h),e.AddNeighbor(A,h),e.AddNeighbor(f,h),A=f,h++;return this.m_triangleCount=h,a.O3DGC_OK},a.TriangleListDecoder.prototype.Decompress=function(){var t;for(t=0;t<this.m_numVertices;++t)t===this.m_vertexCount&&this.m_vertexCount++,this.CompueLocalConnectivityInfo(t),this.DecompressTFAN(t);return a.O3DGC_OK},a.TriangleListDecoder.prototype.Init=function(t,e,i,r){var o,n;for(this.m_numTriangles=e,this.m_numVertices=i,this.m_triangles=t,this.m_vertexCount=0,this.m_triangleCount=0,this.m_itNumTFans.m_count=0,this.m_itDegree.m_count=0,this.m_itConfig.m_count=0,this.m_itOperation.m_count=0,this.m_itIndex.m_count=0,this.m_numVertices>this.m_maxNumVertices&&(this.m_maxNumVertices=this.m_numVertices,this.m_visitedVerticesValence=new Int32Array(this.m_numVertices),this.m_visitedVertices=new Int32Array(this.m_numVertices)),this.m_decodeTrianglesOrder&&this.m_tempTrianglesSize<this.m_numTriangles&&(this.m_tempTrianglesSize=this.m_numTriangles,this.m_tempTriangles=new Int32Array(3*this.m_tempTrianglesSize)),this.m_ctfans.SetStreamType(this.m_streamType),this.m_ctfans.Allocate(this.m_numVertices,this.m_numTriangles),this.m_tfans.Allocate(2*this.m_numVertices,8*this.m_numVertices),this.m_vertexToTriangle.AllocateNumNeighborsArray(i),n=this.m_vertexToTriangle.GetNumNeighborsBuffer(),o=0;o<i;++o)n[o]=r;return this.m_vertexToTriangle.AllocateNeighborsArray(),this.m_vertexToTriangle.ClearNeighborsArray(),a.O3DGC_OK},a.TriangleListDecoder.prototype.Decode=function(t,e,i,r,o){var n,_;return n=r.ReadUChar(o,this.m_streamType),this.m_decodeTrianglesOrder=0!==(2&n),this.m_decodeVerticesOrder=0!==(1&n),this.m_decodeVerticesOrder?a.O3DGC_ERROR_NON_SUPPORTED_FEATURE:(_=r.ReadUInt32(o,this.m_streamType),this.Init(t,e,i,_),this.m_ctfans.Load(r,o,this.m_decodeTrianglesOrder,this.m_streamType),this.Decompress(),a.O3DGC_OK)},a.SC3DMCDecoder=function(){var t;for(this.m_iterator=new a.Iterator,this.m_streamSize=0,this.m_params=new a.SC3DMCEncodeParams,this.m_triangleListDecoder=new a.TriangleListDecoder,this.m_quantFloatArray={},this.m_orientation={},this.m_normals={},this.m_quantFloatArraySize=0,this.m_normalsSize=0,this.m_orientationSize=0,this.m_stats=new a.SC3DMCStats,this.m_streamType=s.O3DGC_STREAM_TYPE_UNKOWN,this.m_neighbors=[],this.m_idelta=new Float32Array(s.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES),this.m_minNormal=new Float32Array(2),this.m_maxNormal=new Float32Array(2),this.m_minNormal[0]=this.m_minNormal[1]=-2,this.m_maxNormal[0]=this.m_maxNormal[1]=2,t=0;t<s.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES;++t)this.m_neighbors[t]=new a.SC3DMCPredictor},a.SC3DMCDecoder.prototype.GetStats=function(){return this.m_stats},a.SC3DMCDecoder.prototype.DecodeHeader=function(t,e){var i,r,o,n,_,m;if(i=this.m_iterator.m_count,r=e.ReadUInt32(this.m_iterator,s.O3DGC_STREAM_TYPE_BINARY),r!==s.O3DGC_SC3DMC_START_CODE){if(this.m_iterator.m_count=i,r=e.ReadUInt32(this.m_iterator,s.O3DGC_STREAM_TYPE_ASCII),r!==s.O3DGC_SC3DMC_START_CODE)return a.O3DGC_ERROR_CORRUPTED_STREAM;this.m_streamType=s.O3DGC_STREAM_TYPE_ASCII}else this.m_streamType=s.O3DGC_STREAM_TYPE_BINARY;if(this.m_streamSize=e.ReadUInt32(this.m_iterator,this.m_streamType),this.m_params.SetEncodeMode(e.ReadUChar(this.m_iterator,this.m_streamType)),t.SetCreaseAngle(e.ReadFloat32(this.m_iterator,this.m_streamType)),o=e.ReadUChar(this.m_iterator,this.m_streamType),t.SetCCW(1===(1&o)),t.SetSolid(1===(2&o)),t.SetConvex(1===(4&o)),t.SetIsTriangularMesh(1===(8&o)),t.SetNCoord(e.ReadUInt32(this.m_iterator,this.m_streamType)),t.SetNNormal(e.ReadUInt32(this.m_iterator,this.m_streamType)),t.SetNumFloatAttributes(e.ReadUInt32(this.m_iterator,this.m_streamType)),t.SetNumIntAttributes(e.ReadUInt32(this.m_iterator,this.m_streamType)),t.GetNCoord()>0){for(t.SetNCoordIndex(e.ReadUInt32(this.m_iterator,this.m_streamType)),n=0;n<3;++n)t.SetCoordMin(n,e.ReadFloat32(this.m_iterator,this.m_streamType)),t.SetCoordMax(n,e.ReadFloat32(this.m_iterator,this.m_streamType));this.m_params.SetCoordQuantBits(e.ReadUChar(this.m_iterator,this.m_streamType))}if(t.GetNNormal()>0){for(t.SetNNormalIndex(e.ReadUInt32(this.m_iterator,this.m_streamType)),n=0;n<3;++n)t.SetNormalMin(n,e.ReadFloat32(this.m_iterator,this.m_streamType)),t.SetNormalMax(n,e.ReadFloat32(this.m_iterator,this.m_streamType));t.SetNormalPerVertex(1===e.ReadUChar(this.m_iterator,this.m_streamType)),this.m_params.SetNormalQuantBits(e.ReadUChar(this.m_iterator,this.m_streamType))}for(_=0;_<t.GetNumFloatAttributes();++_)if(t.SetNFloatAttribute(_,e.ReadUInt32(this.m_iterator,this.m_streamType)),t.GetNFloatAttribute(_)>0){for(t.SetNFloatAttributeIndex(_,e.ReadUInt32(this.m_iterator,this.m_streamType)),m=e.ReadUChar(this.m_iterator,this.m_streamType),t.SetFloatAttributeDim(_,m),n=0;n<m;++n)t.SetFloatAttributeMin(_,n,e.ReadFloat32(this.m_iterator,this.m_streamType)),t.SetFloatAttributeMax(_,n,e.ReadFloat32(this.m_iterator,this.m_streamType));t.SetFloatAttributePerVertex(_,1===e.ReadUChar(this.m_iterator,this.m_streamType)),t.SetFloatAttributeType(_,e.ReadUChar(this.m_iterator,this.m_streamType)),this.m_params.SetFloatAttributeQuantBits(_,e.ReadUChar(this.m_iterator,this.m_streamType))}for(_=0;_<t.GetNumIntAttributes();++_)t.SetNIntAttribute(_,e.ReadUInt32(this.m_iterator,this.m_streamType)),t.GetNIntAttribute(_)>0&&(t.SetNIntAttributeIndex(_,e.ReadUInt32(this.m_iterator,this.m_streamType)),t.SetIntAttributeDim(_,e.ReadUChar(this.m_iterator,this.m_streamType)),t.SetIntAttributePerVertex(_,1===e.ReadUChar(this.m_iterator,this.m_streamType)),t.SetIntAttributeType(_,e.ReadUChar(this.m_iterator,this.m_streamType)));return a.O3DGC_OK},a.SC3DMCDecoder.prototype.DecodeIntArrayBinary=function(t,e,i,r,o,_,m){var h,d,u,c,C,l,A,f,p,D,S,I,T,y,O,G,M,N,R,b,E,F,x,B,g,U,V,v,P,z,w,L;if(p=this.m_iterator,D=this.m_streamType,I=new a.ArithmeticDecoder,T=new a.StaticBitModel,y=new a.AdaptiveBitModel,O=new a.AdaptiveDataModel,O.SetAlphabet(s.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS+1),G=this.m_triangleListDecoder.GetVertexToTriangle(),M=G.m_neighbors,N=o.GetCoordIndex(),R=e*i,b=p.m_count,E=m.ReadUInt32(p,D),F=m.ReadUChar(p,D),x=F>>>4&7,_.m_value=7&F,E-=p.m_count-b,B=new a.Iterator,B.m_count=p.m_count+E,g=0,U=0,V=new a.SC3DMCTriplet(-1,-1,-1),x!==s.O3DGC_SC3DMC_BINARIZATION_AC_EGC)return a.O3DGC_ERROR_CORRUPTED_STREAM;for(f=m.GetBuffer(p,E),p.m_count+=E,I.SetBuffer(E,f),I.StartDecoder(),g=I.ExpGolombDecode(0,T,y),U=I.ExpGolombDecode(0,T,y),v=new a.AdaptiveDataModel,v.SetAlphabet(U+2),P=this.m_neighbors,z=this.m_normals,w=new a.NumberRef,h=_.m_value!==s.O3DGC_SC3DMC_NO_PREDICTION,L=0;L<e;++L){if(w.m_value=0,G.GetNumNeighbors(L)>0&&h)for(l=G.Begin(L),A=G.End(L),c=l;c<A&&(C=M[c],!(C<0));++c)n(N,C,L,w,P,i,t,r);if(w.m_value>1)for(d=I.DecodeAdaptiveDataModel(O),u=0;u<i;++u)S=I.DecodeIntACEGC(v,T,y,g,U),t[L*r+u]=S+P[d].m_pred[u];else if(L>0&&_.m_value!==s.O3DGC_SC3DMC_NO_PREDICTION)for(u=0;u<i;++u)S=I.DecodeIntACEGC(v,T,y,g,U),t[L*r+u]=S+t[(L-1)*r+u];else for(u=0;u<i;++u)S=I.DecodeUIntACEGC(v,T,y,g,U),t[L*r+u]=S}return p.m_count=B.m_count,a.O3DGC_OK},a.SC3DMCDecoder.prototype.DecodeIntArrayASCII=function(t,e,i,r,o,_,m){var h,d,u,c,C,l,A,f,p,D,S,I,T,y,O,G,M,N,R,b,E,F,x,B;if(d=this.m_iterator,u=this.m_streamType,C=this.m_triangleListDecoder.GetVertexToTriangle(),l=C.m_neighbors,A=o.GetCoordIndex(),f=e*i,p=d.m_count,D=m.ReadUInt32(d,u),S=m.ReadUChar(d,u),I=S>>>4&7,_.m_value=7&S,D-=d.m_count-p,T=new a.Iterator,T.m_count=d.m_count+D,y=new a.SC3DMCTriplet(-1,-1,-1),I!==s.O3DGC_SC3DMC_BINARIZATION_ASCII)return a.O3DGC_ERROR_CORRUPTED_STREAM;for(m.ReadUInt32(T,u),O=this.m_neighbors,G=this.m_normals,M=new a.NumberRef,h=_.m_value!==s.O3DGC_SC3DMC_NO_PREDICTION,N=0;N<e;++N){if(M.m_value=0,C.GetNumNeighbors(N)>0&&h)for(R=C.Begin(N),b=C.End(N),E=R;E<b&&(F=l[E],!(F<0));++E)n(A,F,N,M,O,i,t,r);if(M.m_value>1)for(B=m.ReadUCharASCII(T),x=0;x<i;++x)c=m.ReadIntASCII(d),t[N*r+x]=c+O[B].m_pred[x];else if(N>0&&_.m_value!==s.O3DGC_SC3DMC_NO_PREDICTION)for(x=0;x<i;++x)c=m.ReadIntASCII(d),t[N*r+x]=c+t[(N-1)*r+x];else for(x=0;x<i;++x)c=m.ReadUIntASCII(d),t[N*r+x]=c}return d.m_count=T.m_count,a.O3DGC_OK},a.SC3DMCDecoder.prototype.DecodeIntArray=function(t,e,i,r,o,n,_){return this.m_streamType===s.O3DGC_STREAM_TYPE_ASCII?this.DecodeIntArrayASCII(t,e,i,r,o,n,_):this.DecodeIntArrayBinary(t,e,i,r,o,n,_)},a.SC3DMCDecoder.prototype.ProcessNormals=function(t){var e,r,o,n,_,s,h,d,u,c,C,l,A,f,p;for(o=t.GetNNormal(),n=3*t.GetNNormal(),this.m_normalsSize<n&&(this.m_normalsSize=n,this.m_normals=new Float32Array(this.m_normalsSize)),_=this.m_normals,s=this.m_quantFloatArray,h=this.m_orientation,d=t.GetCoordIndex(),m(d,t.GetNCoordIndex(),s,o,_),u=new a.Vec3,c=new a.Vec3,C=0;C<o;++C)e=3*C,u.m_x=_[e],u.m_y=_[e+1],u.m_z=_[e+2],p=Math.sqrt(u.m_x*u.m_x+u.m_y*u.m_y+u.m_z*u.m_z),0===p&&(p=1),i(u,c),l=c.m_x/p,A=c.m_y/p,f=c.m_z+h[C],h[C]=f,f>>>1!==c.m_z>>>1&&(l=0,A=0),r=2*C,_[r]=l,_[r+1]=A;return a.O3DGC_OK},a.SC3DMCDecoder.prototype.IQuantize=function(t,e,i,r,o,n,_,m){var h,d,u,c,C,l;if(m.m_value===s.O3DGC_SC3DMC_SURF_NORMALS_PREDICTION)for(l=s.CubeToSphere,c=this.m_orientation,C=this.m_normals,d=new a.Vec3(0,0,0),u=new a.Vec3(0,0,0),this.IQuantizeFloatArray(t,e,i,r,this.m_minNormal,this.m_maxNormal,_+1),h=0;h<e;++h)d.m_x=t[r*h]+C[2*h],d.m_y=t[r*h+1]+C[2*h+1],d.m_z=c[h],l[d.m_z](d,u),t[r*h]=u.m_x,t[r*h+1]=u.m_y,t[r*h+2]=u.m_z;else this.IQuantizeFloatArray(t,e,i,r,o,n,_)},a.SC3DMCDecoder.prototype.DecodeFloatArrayBinary=function(t,e,i,r,m,h,d,u,c,C){var l,A,f,p,D,S,I,T,y,O,G,M,N,R,b,E,F,x,B,g,U,V,v,P,z,w,L,Y,X,H,K,q,Q,Z,k,j;if(F=this.m_iterator,x=this.m_orientation,B=this.m_streamType,U=new a.ArithmeticDecoder,V=new a.StaticBitModel,v=new a.AdaptiveBitModel,P=new a.AdaptiveDataModel,l=s.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS,P.SetAlphabet(l+1),z=this.m_triangleListDecoder.GetVertexToTriangle(),w=z.m_neighbors,L=u.GetCoordIndex(),Y=e*i,X=F.m_count,H=C.ReadUInt32(F,B),K=C.ReadUChar(F,B),q=K>>>4&7,c.m_value=7&K,H-=F.m_count-X,Q=new a.Iterator,Q.m_count=F.m_count+H,Z=0,k=0,q!==s.O3DGC_SC3DMC_BINARIZATION_AC_EGC)return a.O3DGC_ERROR_CORRUPTED_STREAM;if(S=C.GetBuffer(F,H),F.m_count+=H,U.SetBuffer(H,S),U.StartDecoder(),Z=U.ExpGolombDecode(0,V,v),k=U.ExpGolombDecode(0,V,v),j=new a.AdaptiveDataModel,j.SetAlphabet(k+2),c.m_value===s.O3DGC_SC3DMC_SURF_NORMALS_PREDICTION){for(this.m_orientationSize<Y&&(this.m_orientationSize=Y,this.m_orientation=new Int8Array(this.m_orientationSize),x=this.m_orientation),D=new a.AdaptiveDataModel,D.SetAlphabet(12),M=0;M<e;++M)x[M]=o(U.DecodeAdaptiveDataModel(D));this.ProcessNormals(u),i=2}for(this.m_quantFloatArraySize<Y&&(this.m_quantFloatArraySize=Y,this.m_quantFloatArray=new Int32Array(this.m_quantFloatArraySize)),I=this.m_quantFloatArray,T=this.m_neighbors,y=this.m_normals,O=new a.NumberRef,A=c.m_value!==s.O3DGC_SC3DMC_NO_PREDICTION,f=c.m_value===s.O3DGC_SC3DMC_PARALLELOGRAM_PREDICTION,N=0;N<e;++N){if(O.m_value=0,z.GetNumNeighbors(N)>0&&A){if(b=z.Begin(N),E=z.End(N),f)for(R=b;R<E&&(G=w[R],!(G<0));++R)_(L,G,N,O,T,i,I,r,z,w);if(O.m_value<l)for(R=b;R<E&&(G=w[R],!(G<0));++R)n(L,G,N,O,T,i,I,r)}if(O.m_value>1)for(p=U.DecodeAdaptiveDataModel(P),M=0;M<i;++M)g=U.DecodeIntACEGC(j,V,v,Z,k),I[N*r+M]=g+T[p].m_pred[M];else if(N>0&&A)for(M=0;M<i;++M)g=U.DecodeIntACEGC(j,V,v,Z,k),I[N*r+M]=g+I[(N-1)*r+M];else for(M=0;M<i;++M)g=U.DecodeUIntACEGC(j,V,v,Z,k),I[N*r+M]=g}return F.m_count=Q.m_count,this.IQuantize(t,e,i,r,m,h,d,c),a.O3DGC_OK},a.SC3DMCDecoder.prototype.DecodeFloatArrayASCII=function(t,e,i,r,o,m,h,d,u,c){var C,l,A,f,p,D,S,I,T,y,O,G,M,N,R,b,E,F,x,B,g,U,V,v,P,z,w;if(C=s.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS,f=this.m_iterator,p=this.m_orientation,D=this.m_streamType,I=this.m_triangleListDecoder.GetVertexToTriangle(),T=I.m_neighbors,y=d.GetCoordIndex(),O=e*i,G=f.m_count,M=c.ReadUInt32(f,D),N=c.ReadUChar(f,D),R=N>>>4&7,u.m_value=7&N,M-=f.m_count-G,b=new a.Iterator,b.m_count=f.m_count+M,R!==s.O3DGC_SC3DMC_BINARIZATION_ASCII)return a.O3DGC_ERROR_CORRUPTED_STREAM;if(c.ReadUInt32(b,D),u.m_value===s.O3DGC_SC3DMC_SURF_NORMALS_PREDICTION){for(this.m_orientationSize<e&&(this.m_orientationSize=e,this.m_orientation=new Int8Array(this.m_orientationSize),p=this.m_orientation),z=0;z<e;++z)p[z]=c.ReadIntASCII(f);this.ProcessNormals(d),i=2}for(this.m_quantFloatArraySize<O&&(this.m_quantFloatArraySize=O,this.m_quantFloatArray=new Int32Array(this.m_quantFloatArraySize)),E=this.m_quantFloatArray,F=this.m_neighbors,x=this.m_normals,B=new a.NumberRef,l=u.m_value!==s.O3DGC_SC3DMC_NO_PREDICTION,A=u.m_value===s.O3DGC_SC3DMC_PARALLELOGRAM_PREDICTION,g=0;g<e;++g){if(B.m_value=0,I.GetNumNeighbors(g)>0&&l){if(V=I.Begin(g),v=I.End(g),A)for(U=V;U<v&&(P=T[U],!(P<0));++U)_(y,P,g,B,F,i,E,r,I,T);if(B.m_value<C)for(U=V;U<v&&(P=T[U],!(P<0));++U)n(y,P,g,B,F,i,E,r)}if(B.m_value>1)for(w=c.ReadUCharASCII(b),z=0;z<i;++z)S=c.ReadIntASCII(f),E[g*r+z]=S+F[w].m_pred[z];else if(g>0&&u.m_value!==s.O3DGC_SC3DMC_NO_PREDICTION)for(z=0;z<i;++z)S=c.ReadIntASCII(f),E[g*r+z]=S+E[(g-1)*r+z];else for(z=0;z<i;++z)S=c.ReadUIntASCII(f),E[g*r+z]=S}return f.m_count=b.m_count,this.IQuantize(t,e,i,r,o,m,h,u),a.O3DGC_OK},a.SC3DMCDecoder.prototype.DecodeFloatArray=function(t,e,i,r,o,n,_,m,a,h){return this.m_streamType===s.O3DGC_STREAM_TYPE_ASCII?this.DecodeFloatArrayASCII(t,e,i,r,o,n,_,m,a,h):this.DecodeFloatArrayBinary(t,e,i,r,o,n,_,m,a,h)},a.SC3DMCDecoder.prototype.IQuantizeFloatArray=function(t,e,i,r,o,n,_){var m,s,h,d,u;for(m=this.m_idelta,s=this.m_quantFloatArray,h=0;h<i;++h)d=n[h]-o[h],d>0?m[h]=d/((1<<_>>>0)-1):m[h]=1;for(u=0;u<e;++u)for(h=0;h<i;++h)t[u*r+h]=s[u*r+h]*m[h]+o[h];return a.O3DGC_OK},a.SC3DMCDecoder.prototype.DecodePlayload=function(t,e){var i,r,o,n,_,m,s;if(i=this.m_params,r=this.m_iterator,o=this.m_stats,n=new a.NumberRef,_=new a.Timer,m=a.O3DGC_OK,this.m_triangleListDecoder.SetStreamType(this.m_streamType),o.m_streamSizeCoordIndex=r.m_count,_.Tic(),this.m_triangleListDecoder.Decode(t.GetCoordIndex(),t.GetNCoordIndex(),t.GetNCoord(),e,r),_.Toc(),o.m_timeCoordIndex=_.GetElapsedTime(),o.m_streamSizeCoordIndex=r.m_count-o.m_streamSizeCoordIndex,o.m_streamSizeCoord=r.m_count,_.Tic(),t.GetNCoord()>0&&(m=this.DecodeFloatArray(t.GetCoord(),t.GetNCoord(),3,3,t.GetCoordMinArray(),t.GetCoordMaxArray(),i.GetCoordQuantBits(),t,n,e),i.SetCoordPredMode(n.m_value)),m!==a.O3DGC_OK)return m;if(_.Toc(),o.m_timeCoord=_.GetElapsedTime(),o.m_streamSizeCoord=r.m_count-o.m_streamSizeCoord,o.m_streamSizeNormal=r.m_count,_.Tic(),t.GetNNormal()>0&&(m=this.DecodeFloatArray(t.GetNormal(),t.GetNNormal(),3,3,t.GetNormalMinArray(),t.GetNormalMaxArray(),i.GetNormalQuantBits(),t,n,e),i.SetNormalPredMode(n.m_value)),m!==a.O3DGC_OK)return m;for(_.Toc(),o.m_timeNormal=_.GetElapsedTime(),o.m_streamSizeNormal=r.m_count-o.m_streamSizeNormal,s=0;s<t.GetNumFloatAttributes();++s)o.m_streamSizeFloatAttribute[s]=r.m_count,_.Tic(),m=this.DecodeFloatArray(t.GetFloatAttribute(s),t.GetNFloatAttribute(s),t.GetFloatAttributeDim(s),t.GetFloatAttributeDim(s),t.GetFloatAttributeMinArray(s),t.GetFloatAttributeMaxArray(s),i.GetFloatAttributeQuantBits(s),t,n,e),i.SetFloatAttributePredMode(s,n.m_value),_.Toc(),o.m_timeFloatAttribute[s]=_.GetElapsedTime(),o.m_streamSizeFloatAttribute[s]=r.m_count-o.m_streamSizeFloatAttribute[s];if(m!==a.O3DGC_OK)return m;for(s=0;s<t.GetNumIntAttributes();++s)o.m_streamSizeIntAttribute[s]=r.m_count,_.Tic(),m=this.DecodeIntArray(t.GetIntAttribute(s),t.GetNIntAttribute(s),t.GetIntAttributeDim(s),t.GetIntAttributeDim(s),t,n,e),i.SetIntAttributePredMode(s,n.m_value),_.Toc(),o.m_timeIntAttribute[s]=_.GetElapsedTime(),o.m_streamSizeIntAttribute[s]=r.m_count-o.m_streamSizeIntAttribute[s];return m!==a.O3DGC_OK?m:(_.Tic(),this.m_triangleListDecoder.Reorder(),_.Toc(),o.m_timeReorder=_.GetElapsedTime(),m)},a.DVEncodeParams=function(){this.m_encodeMode=s.O3DGC_DYNAMIC_VECTOR_ENCODE_MODE_LIFT,this.m_streamTypeMode=s.O3DGC_STREAM_TYPE_ASCII,this.m_quantBits=10},a.DVEncodeParams.prototype.GetStreamType=function(){return this.m_streamTypeMode},a.DVEncodeParams.prototype.GetEncodeMode=function(){return this.m_encodeMode},a.DVEncodeParams.prototype.GetQuantBits=function(){return this.m_quantBits},a.DVEncodeParams.prototype.SetStreamType=function(t){this.m_streamTypeMode=t},a.DVEncodeParams.prototype.SetEncodeMode=function(t){this.m_encodeMode=t},a.DVEncodeParams.prototype.SetQuantBits=function(t){this.m_quantBits=t},a.DynamicVector=function(){this.m_num=0,this.m_dim=0,this.m_stride=0,this.m_max={},this.m_min={},this.m_vectors={}},a.DynamicVector.prototype.GetNVector=function(){return this.m_num},a.DynamicVector.prototype.GetDimVector=function(){return this.m_dim},a.DynamicVector.prototype.GetStride=function(){return this.m_stride},a.DynamicVector.prototype.GetMinArray=function(){return this.m_min},a.DynamicVector.prototype.GetMaxArray=function(){return this.m_max},a.DynamicVector.prototype.GetVectors=function(){return this.m_vectors},a.DynamicVector.prototype.GetMin=function(t){return this.m_min[t]},a.DynamicVector.prototype.GetMax=function(t){return this.m_max[t]},a.DynamicVector.prototype.SetNVector=function(t){this.m_num=t},a.DynamicVector.prototype.SetDimVector=function(t){this.m_dim=t},a.DynamicVector.prototype.SetStride=function(t){this.m_stride=t},a.DynamicVector.prototype.SetMinArray=function(t){this.m_min=t},a.DynamicVector.prototype.SetMaxArray=function(t){this.m_max=t},a.DynamicVector.prototype.SetMin=function(t,e){this.m_min[t]=e},a.DynamicVector.prototype.SetMax=function(t,e){this.m_max[t]=e},a.DynamicVector.prototype.SetVectors=function(t){this.m_vectors=t},a.DynamicVectorDecoder=function(){this.m_streamSize=0,this.m_maxNumVectors=0,this.m_numVectors=0,this.m_dimVectors=0,this.m_quantVectors={},this.m_iterator=new a.Iterator,this.m_streamType=s.O3DGC_STREAM_TYPE_UNKOWN,this.m_params=new a.DVEncodeParams},a.DynamicVectorDecoder.prototype.GetStreamType=function(){return this.m_streamType},a.DynamicVectorDecoder.prototype.GetIterator=function(){return this.m_iterator},a.DynamicVectorDecoder.prototype.SetStreamType=function(t){this.m_streamType=t},a.DynamicVectorDecoder.prototype.SetIterator=function(t){this.m_iterator=t},a.DynamicVectorDecoder.prototype.IUpdate=function(t,e,i){var r,o;for(o=i-1,r=2,t[e]-=t[e+1]>>1;r<o;)t[e+r]-=t[e+r-1]+t[e+r+1]+2>>2,r+=2;return r===o&&(t[e+r]-=t[e+r-1]>>1),a.O3DGC_OK},a.DynamicVectorDecoder.prototype.IPredict=function(t,e,i){var r,o;for(o=i-1,r=1;r<o;)t[e+r]+=t[e+r-1]+t[e+r+1]+1>>1,r+=2;return r===o&&(t[e+r]+=t[e+r-1]),a.O3DGC_OK},a.DynamicVectorDecoder.prototype.Merge=function(t,e,i){var r,o,n,_,m;for(o=(i>>1)+(1&i),n=o-1,_=o;n>0;){for(r=n;r<_;r+=2)m=t[e+r],t[e+r]=t[e+r+1],t[e+r+1]=m;--n,++_}return a.O3DGC_OK},a.DynamicVectorDecoder.prototype.ITransform=function(t,e,i){var r,o,n,_;for(r=i,o=0,n=0,o+=(1&r)<<n++>>>0;r>1;)r=(r>>1)+((1&r)>>>0),o+=(1&r)<<n++>>>0;for(_=n-2;_>=0;--_)r=(r<<1>>>0)-(o>>>_&1)>>>0,this.Merge(t,e,r),this.IUpdate(t,e,r),this.IPredict(t,e,r);return a.O3DGC_OK},a.DynamicVectorDecoder.prototype.IQuantize=function(t,e,i,r,o,n,_){var m,s,h,d,u,c;for(m=this.m_quantVectors,d=e*i,u=0;u<i;++u)for(s=n[u]-o[u],h=s>0?s/((1<<_>>>0)-1):1,c=0;c<e;++c)t[c*r+u]=m[c+u*e]*h+o[u];return a.O3DGC_OK},a.DynamicVectorDecoder.prototype.DecodeHeader=function(t,e){var i,r,o,n;if(i=this.m_iterator,r=i.m_count,o=e.ReadUInt32(i,s.O3DGC_STREAM_TYPE_BINARY),o!==s.O3DGC_DV_START_CODE){if(i.m_count=r,o=e.ReadUInt32(i,s.O3DGC_STREAM_TYPE_ASCII),o!==s.O3DGC_DV_START_CODE)return a.O3DGC_ERROR_CORRUPTED_STREAM;this.m_streamType=s.O3DGC_STREAM_TYPE_ASCII}else this.m_streamType=s.O3DGC_STREAM_TYPE_BINARY;return n=this.m_streamType,this.m_streamSize=e.ReadUInt32(i,n),this.m_params.SetEncodeMode(e.ReadUChar(i,n)),t.SetNVector(e.ReadUInt32(i,n)),t.GetNVector()>0&&(t.SetDimVector(e.ReadUInt32(i,n)),this.m_params.SetQuantBits(e.ReadUChar(i,n))),a.O3DGC_OK},a.DynamicVectorDecoder.prototype.DecodePlayload=function(t,e){var i,r,o,n,_,m,h,d,u,c,C,l,A,f,p,D,S,I,T;for(r=this.m_iterator,o=this.m_streamType,n=a.O3DGC_OK,_=r.m_count,m=e.ReadUInt32(r,o),h=t.GetDimVector(),d=t.GetNVector(),i=h*d,u=0;u<t.GetDimVector();++u)t.SetMin(u,e.ReadFloat32(r,o)),t.SetMax(u,e.ReadFloat32(r,o));if(c=new a.ArithmeticDecoder,C=new a.StaticBitModel,l=new a.AdaptiveBitModel,m-=r.m_count-_,A=0,f=0,o===s.O3DGC_STREAM_TYPE_BINARY&&(p=e.GetBuffer(r,m),r.m_count+=m,c.SetBuffer(m,p),c.StartDecoder(),A=c.ExpGolombDecode(0,C,l),f=c.ExpGolombDecode(0,C,l)),D=new a.AdaptiveDataModel,D.SetAlphabet(f+2),this.m_maxNumVectors<i&&(this.m_maxNumVectors=i,this.m_quantVectors=new Int32Array(this.m_maxNumVectors)),S=this.m_quantVectors,o===s.O3DGC_STREAM_TYPE_ASCII)for(I=0;I<d;++I)for(T=0;T<h;++T)S[T*d+I]=e.ReadIntASCII(r);else for(I=0;I<d;++I)for(T=0;T<h;++T)S[T*d+I]=c.DecodeIntACEGC(D,C,l,A,f);
for(T=0;T<h;++T)this.ITransform(S,T*d,d);return this.IQuantize(t.GetVectors(),d,h,t.GetStride(),t.GetMinArray(),t.GetMaxArray(),this.m_params.GetQuantBits()),n},a}();