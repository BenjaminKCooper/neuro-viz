<!DOCTYPE html><html lang="en"><head>
		<title> three.js webgl - ShadowMesh </title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,user-scalable=no,minimum-scale=1,maximum-scale=1">
		<style>
			body {
				background-color: rgb(0, 0, 0);
				margin: 0;
				padding: 0;
				overflow: hidden;
			}

			#lightButton {
				position: absolute;
				right: 20px;
				top: 20px;
			}
		</style>
	</head>
	<body>

		<div id="container"></div>
		<input id="lightButton" type="button" value="Switch to PointLight" onclick="lightButtonHandler()">

		<script src="../build/three.js"></script>
		<script src="js/objects/ShadowMesh.js"></script>
		<script>function init(){renderer.setClearColor("rgb(0,150,255)"),renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(SCREEN_WIDTH,SCREEN_HEIGHT),document.getElementById("container").appendChild(renderer.domElement),window.addEventListener("resize",onWindowResize,!1),camera.position.set(0,2.5,10),scene.add(camera),onWindowResize(),sunLight.position.set(5,7,-1),sunLight.lookAt(scene.position),scene.add(sunLight),lightPosition4D.x=sunLight.position.x,lightPosition4D.y=sunLight.position.y,lightPosition4D.z=sunLight.position.z,lightPosition4D.w=.001,arrowDirection.subVectors(scene.position,sunLight.position).normalize(),arrowPosition1.copy(sunLight.position),arrowHelper1=new THREE.ArrowHelper(arrowDirection,arrowPosition1,.9,16776960,.25,.08),scene.add(arrowHelper1),arrowPosition2.copy(sunLight.position).add(new THREE.Vector3(0,.2,0)),arrowHelper2=new THREE.ArrowHelper(arrowDirection,arrowPosition2,.9,16776960,.25,.08),scene.add(arrowHelper2),arrowPosition3.copy(sunLight.position).add(new THREE.Vector3(0,-.2,0)),arrowHelper3=new THREE.ArrowHelper(arrowDirection,arrowPosition3,.9,16776960,.25,.08),scene.add(arrowHelper3);var e=new THREE.SphereGeometry(.09),i=new THREE.MeshBasicMaterial({color:"rgb(255,255,255)"});lightSphere=new THREE.Mesh(e,i),scene.add(lightSphere),lightSphere.visible=!1;var o=new THREE.CylinderGeometry(.05,.05,.13),r=new THREE.MeshBasicMaterial({color:"rgb(75,75,75)"});lightHolder=new THREE.Mesh(o,r),scene.add(lightHolder),lightHolder.visible=!1;var n=new THREE.BoxGeometry(30,.01,40),t=new THREE.MeshLambertMaterial({color:"rgb(0,130,0)"});groundMesh=new THREE.Mesh(n,t),groundMesh.position.y=0,scene.add(groundMesh);var s=new THREE.BoxGeometry(1,1,1),a=new THREE.MeshLambertMaterial({color:"rgb(255,0,0)",emissive:2097152});cube=new THREE.Mesh(s,a),cube.position.z=-1,scene.add(cube),cubeShadow=new THREE.ShadowMesh(cube),scene.add(cubeShadow);var l=new THREE.CylinderGeometry(.3,.3,2),h=new THREE.MeshPhongMaterial({color:"rgb(0,0,255)",emissive:32});cylinder=new THREE.Mesh(l,h),cylinder.position.z=-2.5,scene.add(cylinder),cylinderShadow=new THREE.ShadowMesh(cylinder),scene.add(cylinderShadow);var d=new THREE.TorusGeometry(1,.2,10,16,TWO_PI),E=new THREE.MeshPhongMaterial({color:"rgb(255,0,255)",emissive:2097184});torus=new THREE.Mesh(d,E),torus.position.z=-6,scene.add(torus),torusShadow=new THREE.ShadowMesh(torus),scene.add(torusShadow);var c=new THREE.SphereGeometry(.5,20,10),w=new THREE.MeshPhongMaterial({color:"rgb(255,255,255)",emissive:2236962});sphere=new THREE.Mesh(c,w),sphere.position.set(4,.5,2),scene.add(sphere),sphereShadow=new THREE.ShadowMesh(sphere),scene.add(sphereShadow);var g=new THREE.CylinderGeometry(0,.5,2,4),p=new THREE.MeshPhongMaterial({color:"rgb(255,255,0)",emissive:4456448,shading:THREE.FlatShading,shininess:0});pyramid=new THREE.Mesh(g,p),pyramid.position.set(-4,1,2),scene.add(pyramid),pyramidShadow=new THREE.ShadowMesh(pyramid),scene.add(pyramidShadow)}function animate(){requestAnimationFrame(animate),frameTime=clock.getDelta(),cube.rotation.x+=1*frameTime,cube.rotation.y+=1*frameTime,cylinder.rotation.y+=1*frameTime,cylinder.rotation.z-=1*frameTime,torus.rotation.x-=1*frameTime,torus.rotation.y-=1*frameTime,pyramid.rotation.y+=.5*frameTime,horizontalAngle+=.5*frameTime,horizontalAngle>TWO_PI&&(horizontalAngle-=TWO_PI),cube.position.x=4*Math.sin(horizontalAngle),cylinder.position.x=Math.sin(horizontalAngle)*-4,torus.position.x=4*Math.cos(horizontalAngle),verticalAngle+=1.5*frameTime,verticalAngle>TWO_PI&&(verticalAngle-=TWO_PI),cube.position.y=2*Math.sin(verticalAngle)+2.9,cylinder.position.y=2*Math.sin(verticalAngle)+3.1,torus.position.y=2*Math.cos(verticalAngle)+3.3,cubeShadow.update(groundPlane,lightPosition4D),cylinderShadow.update(groundPlane,lightPosition4D),torusShadow.update(groundPlane,lightPosition4D),sphereShadow.update(groundPlane,lightPosition4D),pyramidShadow.update(groundPlane,lightPosition4D),renderer.render(scene,camera)}function onWindowResize(){SCREEN_WIDTH=window.innerWidth,SCREEN_HEIGHT=window.innerHeight,renderer.setSize(SCREEN_WIDTH,SCREEN_HEIGHT),camera.aspect=SCREEN_WIDTH/SCREEN_HEIGHT,camera.updateProjectionMatrix()}function lightButtonHandler(){useDirectionalLight=!useDirectionalLight,useDirectionalLight?(renderer.setClearColor("rgb(0,150,255)"),groundMesh.material.color.set("rgb(0,130,0)"),sunLight.position.set(5,7,-1),sunLight.lookAt(scene.position),lightPosition4D.x=sunLight.position.x,lightPosition4D.y=sunLight.position.y,lightPosition4D.z=sunLight.position.z,lightPosition4D.w=.001,arrowHelper1.visible=!0,arrowHelper2.visible=!0,arrowHelper3.visible=!0,lightSphere.visible=!1,lightHolder.visible=!1,document.getElementById("lightButton").value="Switch to PointLight"):(renderer.setClearColor("rgb(0,0,0)"),groundMesh.material.color.set("rgb(150,150,150)"),sunLight.position.set(0,6,-2),sunLight.lookAt(scene.position),lightSphere.position.copy(sunLight.position),lightHolder.position.copy(lightSphere.position),lightHolder.position.y+=.12,lightPosition4D.x=sunLight.position.x,lightPosition4D.y=sunLight.position.y,lightPosition4D.z=sunLight.position.z,lightPosition4D.w=.9,arrowHelper1.visible=!1,arrowHelper2.visible=!1,arrowHelper3.visible=!1,lightSphere.visible=!0,lightHolder.visible=!0,document.getElementById("lightButton").value="Switch to DirectionalLight")}var SCREEN_WIDTH=window.innerWidth,SCREEN_HEIGHT=window.innerHeight,scene=new THREE.Scene,camera=new THREE.PerspectiveCamera(55,SCREEN_WIDTH/SCREEN_HEIGHT,1,3e3),clock=new THREE.Clock,renderer=new THREE.WebGLRenderer,sunLight=new THREE.DirectionalLight("rgb(255,255,255)",1),useDirectionalLight=!0,arrowHelper1,arrowHelper2,arrowHelper3,arrowDirection=new THREE.Vector3,arrowPosition1=new THREE.Vector3,arrowPosition2=new THREE.Vector3,arrowPosition3=new THREE.Vector3,groundMesh,lightSphere,lightHolder,pyramid,pyramidShadow,sphere,sphereShadow,box,boxShadow,cube,cubeShadow,cylinder,cylinderShadow,torus,torusShadow,normalVector=new THREE.Vector3(0,1,0),planeConstant=.01,groundPlane=new THREE.Plane(normalVector,planeConstant),lightPosition4D=new THREE.Vector4,verticalAngle=0,horizontalAngle=0,frameTime=0,TWO_PI=2*Math.PI;init(),animate();</script>
	

</body></html>