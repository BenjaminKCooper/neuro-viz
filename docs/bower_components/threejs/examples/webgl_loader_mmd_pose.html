<!DOCTYPE html><html lang="en"><head>
		<title>three.js webgl - loaders - MMD loader</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,user-scalable=no,minimum-scale=1,maximum-scale=1">
		<style>
			body {
				font-family: Monospace;
				background-color: #fff;
				color: #000;
				margin: 0px;
				overflow: hidden;
			}
			#info {
				color: #000;
				position: absolute;
				top: 10px;
				width: 100%;
				text-align: center;
				display:block;
			}
			#info a, .button { color: #f00; font-weight: bold; text-decoration: underline; cursor: pointer }
		</style>
	</head>

	<body>
		<div id="info">
		<a href="http://threejs.org" target="_blank">three.js</a> - MMDLoader test<br>
		<a href="https://github.com/mrdoob/three.js/tree/master/examples/models/mmd#readme" target="_blank">MMD Assets license</a><br>
		Copyright
		<a href="http://www.geocities.jp/higuchuu4/index_e.htm" target="_blank">Model Data</a>
		<a href="http://seiga.nicovideo.jp/seiga/im5162984" target="_blank">Pose Data</a>
		</div>

		<script src="../build/three.js"></script>

		<script src="js/libs/mmdparser.min.js"></script>
		<script src="js/libs/ammo.js"></script>

		<script src="js/loaders/TGALoader.js"></script>
		<script src="js/loaders/MMDLoader.js"></script>
		<script src="js/effects/OutlineEffect.js"></script>
		<script src="js/animation/CCDIKSolver.js"></script>
		<script src="js/animation/MMDPhysics.js"></script>

		<script src="js/Detector.js"></script>
		<script src="js/libs/stats.min.js"></script>
		<script src="js/libs/dat.gui.min.js"></script>

		<script>function init(){function e(){function e(e){return e.slice(e.lastIndexOf("/")+1)}function n(){for(var n in m)c[n]=0;c.pose=-1;for(var d=0;d<t.length;d++)c[e(t[d])]=!1}function d(){for(var e in m)l.push(e)}function o(){for(var n={default:-1},d=0;d<t.length;d++)n[e(t[d])]=d;w.add(c,"pose",n).onChange(a)}function i(){for(var e in m)p.add(c,e,0,1,.01).onChange(r)}function r(){for(var e=0;e<l.length;e++){var n=l[e],d=c[n];mesh.morphTargetInfluences[e]=d}}function a(){var e=parseInt(c.pose);e===-1?mesh.pose():helper.poseAsVpd(mesh,vpds[e])}var s=new dat.GUI,m=mesh.morphTargetDictionary,c={},l=[],w=s.addFolder("Poses"),p=s.addFolder("Morphs");n(),d(),o(),i(),r(),a(),w.open(),p.open()}container=document.createElement("div"),document.body.appendChild(container),camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,2e3),camera.position.z=25,scene=new THREE.Scene;var n=new THREE.AmbientLight(6710886);scene.add(n);var d=new THREE.DirectionalLight(8943462);d.position.set(-1,1,1).normalize(),scene.add(d),renderer=new THREE.WebGLRenderer({antialias:!0}),renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(window.innerWidth,window.innerHeight),renderer.setClearColor(new THREE.Color(16777215)),container.appendChild(renderer.domElement),effect=new THREE.OutlineEffect(renderer);var o=function(e){if(e.lengthComputable){var n=e.loaded/e.total*100;console.log(Math.round(n,2)+"% downloaded")}},i=function(e){},r="models/mmd/miku/miku_v2.pmd",t=["models/mmd/vpds/01.vpd","models/mmd/vpds/02.vpd","models/mmd/vpds/03.vpd","models/mmd/vpds/04.vpd","models/mmd/vpds/05.vpd","models/mmd/vpds/06.vpd","models/mmd/vpds/07.vpd","models/mmd/vpds/08.vpd","models/mmd/vpds/11.vpd"];helper=new THREE.MMDHelper;var a=new THREE.MMDLoader;a.loadModel(r,function(n){function d(){var n=t[r];a.loadVpd(n,function(n){vpds.push(n),r++,r<t.length?d():(e(mesh,vpds),ready=!0)},o,i)}mesh=n,mesh.position.y=-10,scene.add(mesh);var r=0;d()},o,i),document.addEventListener("mousemove",onDocumentMouseMove,!1),window.addEventListener("resize",onWindowResize,!1)}function onWindowResize(){windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),effect.setSize(window.innerWidth,window.innerHeight)}function onDocumentMouseMove(e){mouseX=(e.clientX-windowHalfX)/2,mouseY=(e.clientY-windowHalfY)/2}function animate(){requestAnimationFrame(animate),render()}function render(){effect.render(scene,camera)}var container,stats,camera,scene,renderer,effect,helper,vpds=[],ready=!1,mouseX=0,mouseY=0,windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,clock=new THREE.Clock;init(),animate();</script>

	

</body></html>