module("SetScriptValueCommand"),test("Test SetScriptValueCommand for source (Undo and Redo)",function(){var e=new Editor,t=aBox("The scripted box"),s=new AddObjectCommand(t);s.updatable=!1,e.execute(s);var a={name:"Translate",source:"function( update ) {}"};s=new AddScriptCommand(t,a),s.updatable=!1,e.execute(s);var o=[{name:"Translate",source:"function update( event ) { this.position.x = this.position.x + 1; }"},{name:"Translate",source:"function update( event ) { this.position.y = this.position.y + 1; }"},{name:"Translate",source:"function update( event ) { this.position.z = this.position.z + 1; }"}];o.map(function(s){var o=new SetScriptValueCommand(t,a,"source",s.source,0);o.updatable=!1,e.execute(o)});var r=o.length;ok(e.scripts[t.uuid][0].source==o[r-1].source,"OK, 'source' was set correctly to the last value (expected: '"+o[r-1].source+"', actual: '"+e.scripts[t.uuid][0].source+"')"),e.undo(),ok(e.scripts[t.uuid][0].source==o[r-2].source,"OK, 'source' was set correctly to the second to the last value after undo (expected: '"+o[r-2].source+"', actual: '"+e.scripts[t.uuid][0].source+"')"),e.redo(),ok(e.scripts[t.uuid][0].source==o[r-1].source,"OK, 'source' was set correctly to the last value again after redo (expected: '"+o[r-1].source+"', actual: '"+e.scripts[t.uuid][0].source+"')");var c=["X Script","Y Script","Z Script"];c.map(function(o){s=new SetScriptValueCommand(t,a,"name",o),s.updatable=!1,e.execute(s)});var u=e.scripts[t.uuid][0].name;ok(u==c[c.length-1],"OK, the script name corresponds to the last script name that was assigned"),e.undo(),u=e.scripts[t.uuid][0].name,ok(u==c[c.length-2],"OK, the script name corresponds to the second last script name that was assigned"),e.redo(),u=e.scripts[t.uuid][0].name,ok(u==c[c.length-1],"OK, the script name corresponds to the last script name that was assigned, again")});